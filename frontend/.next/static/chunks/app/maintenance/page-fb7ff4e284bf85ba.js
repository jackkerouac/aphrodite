(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[494],{285:(e,s,a)=>{"use strict";a.d(s,{$:()=>c});var t=a(5155);a(2115);var n=a(9708),r=a(2085),i=a(9434);let l=(0,r.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function c(e){let{className:s,variant:a,size:r,asChild:c=!1,...o}=e,d=c?n.DX:"button";return(0,t.jsx)(d,{"data-slot":"button",className:(0,i.cn)(l({variant:a,size:r,className:s})),...o})}},1284:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},1931:(e,s,a)=>{Promise.resolve().then(a.bind(a,7281))},2523:(e,s,a)=>{"use strict";a.d(s,{p:()=>r});var t=a(5155);a(2115);var n=a(9434);function r(e){let{className:s,type:a,...r}=e;return(0,t.jsx)("input",{type:a,"data-slot":"input",className:(0,n.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...r})}},2525:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("trash-2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},4213:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},5057:(e,s,a)=>{"use strict";a.d(s,{J:()=>i});var t=a(5155);a(2115);var n=a(968),r=a(9434);function i(e){let{className:s,...a}=e;return(0,t.jsx)(n.b,{"data-slot":"label",className:(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...a})}},5339:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6126:(e,s,a)=>{"use strict";a.d(s,{E:()=>c});var t=a(5155);a(2115);var n=a(9708),r=a(2085),i=a(9434);let l=(0,r.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function c(e){let{className:s,variant:a,asChild:r=!1,...c}=e,o=r?n.DX:"span";return(0,t.jsx)(o,{"data-slot":"badge",className:(0,i.cn)(l({variant:a}),s),...c})}},6695:(e,s,a)=>{"use strict";a.d(s,{BT:()=>c,Wu:()=>o,ZB:()=>l,Zp:()=>r,aR:()=>i});var t=a(5155);a(2115);var n=a(9434);function r(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...a})}function i(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...a})}function l(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",s),...a})}function c(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm",s),...a})}function o(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",s),...a})}},6981:(e,s,a)=>{"use strict";a.d(s,{C1:()=>w,bL:()=>y});var t=a(2115),n=a(6101),r=a(6081),i=a(5185),l=a(5845),c=a(5503),o=a(1275),d=a(8905),m=a(3655),u=a(5155),x="Checkbox",[h,p]=(0,r.A)(x),[f,g]=h(x);function b(e){let{__scopeCheckbox:s,checked:a,children:n,defaultChecked:r,disabled:i,form:c,name:o,onCheckedChange:d,required:m,value:h="on",internal_do_not_use_render:p}=e,[g,b]=(0,l.i)({prop:a,defaultProp:null!=r&&r,onChange:d,caller:x}),[j,v]=t.useState(null),[y,N]=t.useState(null),w=t.useRef(!1),k=!j||!!c||!!j.closest("form"),C={checked:g,disabled:i,setChecked:b,control:j,setControl:v,name:o,form:c,value:h,hasConsumerStoppedPropagationRef:w,required:m,defaultChecked:!A(r)&&r,isFormControl:k,bubbleInput:y,setBubbleInput:N};return(0,u.jsx)(f,{scope:s,...C,children:"function"==typeof p?p(C):n})}var j="CheckboxTrigger",v=t.forwardRef((e,s)=>{let{__scopeCheckbox:a,onKeyDown:r,onClick:l,...c}=e,{control:o,value:d,disabled:x,checked:h,required:p,setControl:f,setChecked:b,hasConsumerStoppedPropagationRef:v,isFormControl:y,bubbleInput:N}=g(j,a),w=(0,n.s)(s,f),k=t.useRef(h);return t.useEffect(()=>{let e=null==o?void 0:o.form;if(e){let s=()=>b(k.current);return e.addEventListener("reset",s),()=>e.removeEventListener("reset",s)}},[o,b]),(0,u.jsx)(m.sG.button,{type:"button",role:"checkbox","aria-checked":A(h)?"mixed":h,"aria-required":p,"data-state":D(h),"data-disabled":x?"":void 0,disabled:x,value:d,...c,ref:w,onKeyDown:(0,i.m)(r,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,i.m)(l,e=>{b(e=>!!A(e)||!e),N&&y&&(v.current=e.isPropagationStopped(),v.current||e.stopPropagation())})})});v.displayName=j;var y=t.forwardRef((e,s)=>{let{__scopeCheckbox:a,name:t,checked:n,defaultChecked:r,required:i,disabled:l,value:c,onCheckedChange:o,form:d,...m}=e;return(0,u.jsx)(b,{__scopeCheckbox:a,checked:n,defaultChecked:r,disabled:l,required:i,onCheckedChange:o,name:t,form:d,value:c,internal_do_not_use_render:e=>{let{isFormControl:t}=e;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(v,{...m,ref:s,__scopeCheckbox:a}),t&&(0,u.jsx)(C,{__scopeCheckbox:a})]})}})});y.displayName=x;var N="CheckboxIndicator",w=t.forwardRef((e,s)=>{let{__scopeCheckbox:a,forceMount:t,...n}=e,r=g(N,a);return(0,u.jsx)(d.C,{present:t||A(r.checked)||!0===r.checked,children:(0,u.jsx)(m.sG.span,{"data-state":D(r.checked),"data-disabled":r.disabled?"":void 0,...n,ref:s,style:{pointerEvents:"none",...e.style}})})});w.displayName=N;var k="CheckboxBubbleInput",C=t.forwardRef((e,s)=>{let{__scopeCheckbox:a,...r}=e,{control:i,hasConsumerStoppedPropagationRef:l,checked:d,defaultChecked:x,required:h,disabled:p,name:f,value:b,form:j,bubbleInput:v,setBubbleInput:y}=g(k,a),N=(0,n.s)(s,y),w=(0,c.Z)(d),C=(0,o.X)(i);t.useEffect(()=>{if(!v)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,s=!l.current;if(w!==d&&e){let a=new Event("click",{bubbles:s});v.indeterminate=A(d),e.call(v,!A(d)&&d),v.dispatchEvent(a)}},[v,w,d,l]);let D=t.useRef(!A(d)&&d);return(0,u.jsx)(m.sG.input,{type:"checkbox","aria-hidden":!0,defaultChecked:null!=x?x:D.current,required:h,disabled:p,name:f,value:b,form:j,...r,tabIndex:-1,ref:N,style:{...r.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function A(e){return"indeterminate"===e}function D(e){return A(e)?"indeterminate":e?"checked":"unchecked"}C.displayName=k},7262:(e,s,a)=>{"use strict";a.d(s,{S:()=>l});var t=a(5155);a(2115);var n=a(6981),r=a(5196),i=a(9434);function l(e){let{className:s,...a}=e;return(0,t.jsx)(n.bL,{"data-slot":"checkbox",className:(0,i.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...a,children:(0,t.jsx)(n.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,t.jsx)(r.A,{className:"size-3.5"})})})}},7281:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>J});var t=a(5155),n=a(2115),r=a(7313),i=a(1154),l=a(8313),c=a(6695),o=a(285),d=a(6126),m=a(646),u=a(4861),x=a(3904),h=a(6671);let p={connectionTests:{jellyfin:!1,omdb:!1,tmdb:!1,mdblist:!1,anidb:!1,isTestingAll:!1},databaseInfo:null,integrityStatus:{checked:!1,ok:!1},backupOptions:{compress:!0},cleanupOptions:{keepCount:5},exportOptions:{includeSensitive:!1},logsData:{logs:[],fileInfo:null,availableLevels:[],selectedLevel:"",searchQuery:"",isLoading:!1,error:""}},f=[{name:"Jellyfin",description:"Check connection to Jellyfin server using configured API key",status:null},{name:"OMDB",description:"Check connection to OMDB API using configured API key",status:null},{name:"TMDB",description:"Check connection to TMDB API using configured API key",status:null},{name:"MDBList",description:"Check connection to MDBList API using configured API key",status:null},{name:"AniDB",description:"Check connection to AniDB using configured credentials",status:null}];function g(){let{services:e,isTestingAll:s,testConnection:a,testAllConnections:r}=function(){let[e,s]=(0,n.useState)(f.map(e=>({...e}))),[a,t]=(0,n.useState)(!1),r=async a=>{if(!e.find(e=>e.name===a))return{success:!1,message:"Service not found"};s(e=>e.map(e=>e.name===a?{...e,status:"checking",error:void 0}:e));try{var t,n,r,i;let e="",l={},c=await fetch("".concat("","/api/v1/config/settings.yaml")),o=(await c.json()).config;if(!o||!o.api_keys)throw Error("Configuration not found");switch(a){case"Jellyfin":if(!(null==(t=o.api_keys.Jellyfin)?void 0:t[0]))throw Error("Jellyfin configuration not found");e="/api/v1/config/test-jellyfin",l={url:o.api_keys.Jellyfin[0].url,api_key:o.api_keys.Jellyfin[0].api_key,user_id:o.api_keys.Jellyfin[0].user_id};break;case"OMDB":if(!(null==(n=o.api_keys.OMDB)?void 0:n[0]))throw Error("OMDB configuration not found");e="/api/v1/config/test-omdb",l={api_key:o.api_keys.OMDB[0].api_key};break;case"TMDB":if(!(null==(r=o.api_keys.TMDB)?void 0:r[0]))throw Error("TMDB configuration not found");e="/api/v1/config/test-tmdb",l={api_key:o.api_keys.TMDB[0].api_key};break;case"MDBList":if(!(null==(i=o.api_keys.MDBList)?void 0:i[0]))throw Error("MDBList configuration not found");e="/api/v1/config/test-mdblist",l={api_key:o.api_keys.MDBList[0].api_key};break;case"AniDB":if(!o.api_keys.aniDB)throw Error("AniDB configuration not found");let d="",m="",u="aphrodite",x=1;if(Array.isArray(o.api_keys.aniDB))for(let e of o.api_keys.aniDB)e&&"object"==typeof e&&(e.username&&(d=e.username),e.password&&(m=e.password),e.client_name&&(u=e.client_name),e.version&&(x=e.version));else"object"==typeof o.api_keys.aniDB&&(d=o.api_keys.aniDB.username||"",m=o.api_keys.aniDB.password||"",u=o.api_keys.aniDB.client_name||"aphrodite",x=o.api_keys.aniDB.version||1);if(!d||!m)throw Error("AniDB credentials incomplete");e="/api/v1/config/test-anidb",l={username:d,password:m,client_name:u,version:x};break;default:throw Error("Unknown service")}let h=await fetch("".concat("").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),p=await h.json(),f={success:h.ok&&!1!==p.success,message:p.message||(h.ok?"Connection successful!":"Connection failed")};return s(e=>e.map(e=>e.name===a?{...e,status:f.success?"connected":"failed",error:f.success?void 0:f.message}:e)),f}catch(t){let e=t instanceof Error?t.message:"Connection failed";return s(s=>s.map(s=>s.name===a?{...s,status:"failed",error:e}:s)),{success:!1,message:e}}},i=async()=>{t(!0),console.log("Starting connection check for all services");try{for(let s of e){console.log("Testing connection for ".concat(s.name,"..."));try{await r(s.name),console.log("".concat(s.name," connection check completed"))}catch(e){console.error("Error during ".concat(s.name," connection check:"),e)}}h.oR.success("Connection tests completed")}catch(e){console.error("Error during connection testing:",e),h.oR.error("Failed to complete connection tests")}finally{t(!1),console.log("All connection checks completed")}};return{services:e,isTestingAll:a,testConnection:r,testAllConnections:i,setServices:s}}();return(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{children:[(0,t.jsx)(c.ZB,{children:"API Connection Check"}),(0,t.jsx)(c.BT,{children:"Test connectivity to all configured external services and APIs."})]}),(0,t.jsxs)(c.Wu,{className:"space-y-6",children:[(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(e=>(0,t.jsx)(c.Zp,{className:"bg-muted/50",children:(0,t.jsxs)(c.Wu,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("h3",{className:"text-lg font-medium",children:e.name}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["checking"===e.status&&(0,t.jsx)(i.A,{className:"h-4 w-4 animate-spin"}),e.status&&"checking"!==e.status&&(0,t.jsxs)(d.E,{variant:"connected"===e.status?"default":"destructive",children:["connected"===e.status&&(0,t.jsx)(m.A,{className:"h-3 w-3 mr-1"}),"failed"===e.status&&(0,t.jsx)(u.A,{className:"h-3 w-3 mr-1"}),"connected"===e.status?"Connected":"Failed"]}),!e.status&&(0,t.jsx)(d.E,{variant:"outline",children:"Not tested"})]})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:e.description}),e.error&&(0,t.jsx)("p",{className:"text-sm text-destructive mb-3",children:e.error}),(0,t.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>a(e.name),disabled:"checking"===e.status||s,className:"w-full",children:"checking"===e.status?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.A,{className:"h-4 w-4 animate-spin mr-2"}),"Testing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Test Connection"]})})]})},e.name))}),(0,t.jsx)("div",{className:"flex justify-center pt-4 border-t",children:(0,t.jsx)(o.$,{onClick:r,disabled:s,size:"lg",className:"min-w-48",children:s?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.A,{className:"h-5 w-5 animate-spin mr-2"}),"Testing All Connections..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{className:"h-5 w-5 mr-2"}),"Test All Connections"]})})}),e.some(e=>e.status&&"checking"!==e.status)&&(0,t.jsxs)("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Connection Test Results"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:e.filter(e=>e.status&&"checking"!==e.status).map(e=>(0,t.jsxs)(d.E,{variant:"connected"===e.status?"default":"destructive",className:"flex items-center gap-1",children:["connected"===e.status?(0,t.jsx)(m.A,{className:"h-3 w-3"}):(0,t.jsx)(u.A,{className:"h-3 w-3"}),e.name]},e.name))})]})]})]})}var b=a(2523),j=a(5057),v=a(7262),y=a(4213),N=a(9946);let w=(0,N.A)("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),k=(0,N.A)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);var C=a(1788);let A=(0,N.A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var D=a(2525);let _=(0,N.A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);function S(){var e;let{databaseInfo:s,loading:a,loadDatabaseInfo:r,createBackup:l,restoreBackup:p,exportDatabase:f,importDatabaseSettings:g}=function(){let[e,s]=(0,n.useState)(null),[a,t]=(0,n.useState)({info:!1,backup:!1,restore:!1,verify:!1,cleanup:!1,export:!1,integrity:!1}),r=async()=>{t(e=>({...e,info:!0}));try{console.log("Loading database info from:","".concat("","/api/v1/maintenance/database/status"));let e=await fetch("".concat("","/api/v1/maintenance/database/status"));if(console.log("Database info response status:",e.status),!e.ok)throw Error("HTTP ".concat(e.status,": ").concat(e.statusText));let a=await e.json();console.log("Database info response data:",a),a.success?(s(a),console.log("Database info loaded successfully")):(console.error("Database info request failed:",a),h.oR.error("Failed to load database information: ".concat(a.error||"Unknown error")))}catch(e){console.error("Error loading database info:",e),h.oR.error("Failed to load database information: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{t(e=>({...e,info:!1}))}},i=async e=>{t(e=>({...e,backup:!0}));try{let s=await fetch("".concat("","/api/v1/maintenance/database/backup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await s.json();return a.success?(h.oR.success("Backup created: ".concat(a.backup_filename)),await r()):h.oR.error("Backup failed: ".concat(a.error)),{success:a.success,message:a.success?"Backup created: ".concat(a.backup_filename):a.error,details:a}}catch(s){let e=s instanceof Error?s.message:"Backup failed";return h.oR.error(e),{success:!1,message:e}}finally{t(e=>({...e,backup:!1}))}},l=async e=>{t(e=>({...e,restore:!0}));try{let s=await fetch("".concat("","/api/v1/maintenance/database/restore"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:e})}),a=await s.json();return a.success?(h.oR.success("Database restored successfully"),await r()):h.oR.error("Restore failed: ".concat(a.error)),{success:a.success,message:a.success?"Database restored successfully":a.error,details:a}}catch(s){let e=s instanceof Error?s.message:"Restore failed";return h.oR.error(e),{success:!1,message:e}}finally{t(e=>({...e,restore:!1}))}},c=async e=>{t(e=>({...e,restore:!0}));try{let s=await fetch("".concat("","/api/v1/maintenance/database/import-settings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonData:e,confirm_restore:!1})}),a=await s.json();if(!1===a.success&&a.requires_confirmation){console.log("Backend requires confirmation for import, proceeding with confirmed request");let s=await fetch("".concat("","/api/v1/maintenance/database/import-settings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonData:e,confirm_restore:!0})}),a=await s.json();if(a.success)return h.oR.success("Database settings imported successfully: ".concat(a.tables_imported," tables imported, ").concat(a.tables_failed," failed"),{duration:6e3}),await r(),{success:!0,message:"Database settings imported successfully: ".concat(a.tables_imported," tables imported, ").concat(a.tables_failed," failed"),details:a};return h.oR.error("Import failed: ".concat(a.detail||a.message||"Unknown error")),{success:!1,message:a.detail||a.message||"Import failed",details:a}}if(a.success)return h.oR.success("Database settings imported successfully: ".concat(a.tables_imported," tables imported, ").concat(a.tables_failed," failed"),{duration:6e3}),await r(),{success:!0,message:"Database settings imported successfully: ".concat(a.tables_imported," tables imported, ").concat(a.tables_failed," failed"),details:a};return h.oR.error("Import failed: ".concat(a.detail||a.message||"Unknown error")),{success:!1,message:a.detail||a.message||"Import failed",details:a}}catch(s){let e=s instanceof Error?s.message:"Import failed";return h.oR.error(e),{success:!1,message:e}}finally{t(e=>({...e,restore:!1}))}};return{databaseInfo:e,loading:a,loadDatabaseInfo:r,createBackup:i,restoreBackup:l,exportDatabase:async e=>{t(e=>({...e,export:!0}));try{let s=await fetch("".concat("","/api/v1/maintenance/database/export"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){let e=await s.blob(),a=window.URL.createObjectURL(e),t=document.createElement("a");t.href=a;let n=s.headers.get("Content-Disposition"),r="database_export.json";if(n){let e=n.match(/filename="?([^"]+)"?/);e&&(r=e[1])}return t.download=r,document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(a),document.body.removeChild(t),h.oR.success("Database exported successfully"),{success:!0,message:"Database exported successfully: ".concat(r)}}{let e=await s.json();return h.oR.error("Export failed: ".concat(e.detail||"Unknown error")),{success:!1,message:e.detail||"Export failed"}}}catch(s){let e=s instanceof Error?s.message:"Export failed";return h.oR.error(e),{success:!1,message:e}}finally{t(e=>({...e,export:!1}))}},importDatabaseSettings:c,setDatabaseInfo:s}}(),[N,S]=(0,n.useState)({compress:!0}),[E,R]=(0,n.useState)({keepCount:5}),[B,L]=(0,n.useState)({includeSensitive:!1}),[T,M]=(0,n.useState)({show:!1,backup:null}),[O,z]=(0,n.useState)({show:!1,jsonData:null,filename:""}),[J,I]=(0,n.useState)({checked:!1,ok:!1}),Z=async()=>{I({checked:!0,ok:!0,message:"Database integrity check passed"})},P=async()=>{await l(N)},F=e=>{M({show:!0,backup:e})},U=async()=>{T.backup&&await p(T.backup.filename),M({show:!1,backup:null})},$=async()=>{await f(B)},W=async()=>{O.jsonData&&await g(O.jsonData),z({show:!1,jsonData:null,filename:""})},q=e=>new Date(e).toLocaleString();return(0,n.useEffect)(()=>{console.log("DatabaseOperations: Component mounted, loading database info..."),r()},[]),(0,n.useEffect)(()=>{console.log("DatabaseOperations: databaseInfo changed:",s),console.log("DatabaseOperations: loading state:",a)},[s,a]),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(c.Zp,{children:[(0,t.jsx)(c.aR,{children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(c.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(y.A,{className:"h-5 w-5"}),"Database Information"]}),(0,t.jsx)(c.BT,{children:"View database status and perform integrity checks"})]}),(0,t.jsxs)(o.$,{variant:"outline",size:"sm",onClick:r,disabled:a.info,children:[a.info?(0,t.jsx)(i.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,t.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),(0,t.jsx)(c.Wu,{children:s?(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsx)(c.Zp,{className:"bg-muted/50",children:(0,t.jsx)(c.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Database Status"}),(0,t.jsx)("p",{className:"text-2xl font-bold ".concat(s.database.exists?"text-green-600":"text-red-600"),children:s.database.exists?"Active":"Not Found"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:s.database.path})]}),(0,t.jsx)(w,{className:"h-8 w-8 ".concat(s.database.exists?"text-green-600":"text-red-600")})]})})}),(0,t.jsx)(c.Zp,{className:"bg-muted/50",children:(0,t.jsx)(c.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Database Size"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:s.database.size_formatted}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Schema ",s.schema_version]})]}),(0,t.jsx)(y.A,{className:"h-8 w-8 text-blue-600"})]})})}),(0,t.jsx)(c.Zp,{className:"bg-muted/50",children:(0,t.jsx)(c.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Available Backups"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:s.backups.length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:s.backup_directory})]}),(0,t.jsx)(k,{className:"h-8 w-8 text-purple-600"})]})})}),(0,t.jsx)(c.Zp,{className:"bg-muted/50",children:(0,t.jsx)(c.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:"Integrity Status"}),(0,t.jsx)("p",{className:"text-2xl font-bold ".concat(J.checked?J.ok?"text-green-600":"text-red-600":"text-yellow-600"),children:J.checked?J.ok?"OK":"Issues":"Not Checked"}),(0,t.jsxs)(o.$,{variant:"outline",size:"sm",onClick:Z,disabled:a.integrity,className:"mt-1",children:[a.integrity?(0,t.jsx)(i.A,{className:"h-3 w-3 animate-spin mr-1"}):null,"Check Now"]})]}),J.checked?J.ok?(0,t.jsx)(m.A,{className:"h-8 w-8 text-green-600"}):(0,t.jsx)(u.A,{className:"h-8 w-8 text-red-600"}):(0,t.jsx)(x.A,{className:"h-8 w-8 text-yellow-600"})]})})})]}):(0,t.jsxs)("div",{className:"flex items-center justify-center p-8",children:[(0,t.jsx)(i.A,{className:"h-8 w-8 animate-spin mr-2"}),(0,t.jsx)("span",{children:"Loading database information..."})]})})]}),(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{children:[(0,t.jsxs)(c.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(k,{className:"h-5 w-5"}),"Backup Operations"]}),(0,t.jsx)(c.BT,{children:"Create, restore, and manage database backups"})]}),(0,t.jsxs)(c.Wu,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(j.J,{className:"text-base font-semibold",children:"Create New Backup"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(v.S,{id:"compress-backup",checked:N.compress,onCheckedChange:e=>S(s=>({...s,compress:e}))}),(0,t.jsx)(j.J,{htmlFor:"compress-backup",className:"text-sm",children:"Compress backup"})]}),(0,t.jsxs)(o.$,{onClick:P,disabled:a.backup||!(null==s?void 0:s.database.exists),children:[a.backup?(0,t.jsx)(i.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,t.jsx)(C.A,{className:"h-4 w-4 mr-2"}),"Create Backup"]})]})]}),(null==s?void 0:s.backups)&&s.backups.length>0&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(j.J,{className:"text-base font-semibold",children:"Available Backups"}),(0,t.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,t.jsx)("div",{className:"max-h-96 overflow-y-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{className:"bg-muted/50 border-b",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"text-left p-3 font-medium",children:"Filename"}),(0,t.jsx)("th",{className:"text-left p-3 font-medium",children:"Size"}),(0,t.jsx)("th",{className:"text-left p-3 font-medium",children:"Created"}),(0,t.jsx)("th",{className:"text-left p-3 font-medium",children:"Type"}),(0,t.jsx)("th",{className:"text-left p-3 font-medium",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:s.backups.slice(0,10).map(e=>(0,t.jsxs)("tr",{className:"border-b last:border-b-0 hover:bg-muted/25",children:[(0,t.jsx)("td",{className:"p-3 font-mono text-xs",children:e.filename}),(0,t.jsx)("td",{className:"p-3",children:e.size_formatted}),(0,t.jsx)("td",{className:"p-3",children:q(e.created)}),(0,t.jsx)("td",{className:"p-3",children:(0,t.jsx)(d.E,{variant:e.compressed?"default":"outline",children:e.compressed?"Compressed":"Uncompressed"})}),(0,t.jsx)("td",{className:"p-3",children:(0,t.jsx)("div",{className:"flex gap-1",children:(0,t.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>F(e),disabled:a.restore,title:"Restore from this backup",children:(0,t.jsx)(A,{className:"h-3 w-3"})})})})]},e.filename))})]})})})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(j.J,{className:"text-base font-semibold",children:"Cleanup Old Backups"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("span",{className:"text-sm",children:"Keep"}),(0,t.jsx)(b.p,{type:"number",value:E.keepCount,onChange:e=>R(s=>({...s,keepCount:parseInt(e.target.value)||5})),min:1,max:50,className:"w-20"}),(0,t.jsx)("span",{className:"text-sm",children:"most recent backups"}),(0,t.jsxs)(o.$,{variant:"outline",size:"sm",disabled:a.cleanup||!s||s.backups.length<=E.keepCount,children:[a.cleanup?(0,t.jsx)(i.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,t.jsx)(D.A,{className:"h-4 w-4 mr-2"}),"Cleanup"]})]})]})]})]}),(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{children:[(0,t.jsxs)(c.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(_,{className:"h-5 w-5"}),"Export & Maintenance"]}),(0,t.jsx)(c.BT,{children:"Export database data and perform maintenance operations"})]}),(0,t.jsxs)(c.Wu,{children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(j.J,{className:"text-base font-semibold",children:"Export Database to JSON"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(v.S,{id:"include-sensitive",checked:B.includeSensitive,onCheckedChange:e=>L(s=>({...s,includeSensitive:e}))}),(0,t.jsx)(j.J,{htmlFor:"include-sensitive",className:"text-sm",children:"Include sensitive data"})]}),(0,t.jsxs)(o.$,{onClick:$,disabled:a.export||!(null==s?void 0:s.database.exists),children:[a.export?(0,t.jsx)(i.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,t.jsx)(C.A,{className:"h-4 w-4 mr-2"}),"Export to JSON"]})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"\uD83D\uDCBE The exported file will be automatically downloaded to your browser"})]}),(0,t.jsxs)("div",{className:"space-y-3 pt-4 border-t",children:[(0,t.jsx)(j.J,{className:"text-base font-semibold",children:"Restore Database Settings from JSON"}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("input",{type:"file",accept:".json",onChange:e=>{var s;let a=null==(s=e.target.files)?void 0:s[0];if(!a)return;if(!a.name.endsWith(".json"))return void h.oR.error("Please select a JSON file");let t=new FileReader;t.onload=e=>{try{var s;let t=JSON.parse(null==(s=e.target)?void 0:s.result);z({show:!0,jsonData:t,filename:a.name})}catch(e){h.oR.error("Invalid JSON file format")}},t.readAsText(a),e.target.value=""},style:{display:"none"},id:"json-import-input"}),(0,t.jsxs)(o.$,{variant:"outline",onClick:()=>{var e;return null==(e=document.getElementById("json-import-input"))?void 0:e.click()},disabled:a.restore||!(null==s?void 0:s.database.exists),children:[a.restore?(0,t.jsx)(i.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,t.jsx)(A,{className:"h-4 w-4 mr-2"}),"Select JSON File"]})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"⚠️ This will replace current database settings with data from the JSON export file"})]})]})]}),T.show&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,t.jsxs)(c.Zp,{className:"w-full max-w-md mx-4",children:[(0,t.jsx)(c.aR,{children:(0,t.jsx)(c.ZB,{className:"text-yellow-600",children:"⚠️ Confirm Database Restore"})}),(0,t.jsxs)(c.Wu,{className:"space-y-4",children:[(0,t.jsxs)("p",{children:["This will ",(0,t.jsx)("strong",{children:"replace"})," your current database with the backup:"]}),(0,t.jsxs)("div",{className:"bg-muted p-3 rounded",children:[(0,t.jsx)("p",{className:"font-medium",children:null==(e=T.backup)?void 0:e.filename}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Created: ",T.backup?q(T.backup.created):""]})]}),(0,t.jsxs)("p",{className:"text-destructive text-sm",children:[(0,t.jsx)("strong",{children:"This action cannot be undone!"})," Your current database will be backed up automatically before the restore."]}),(0,t.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,t.jsx)(o.$,{variant:"outline",onClick:()=>M({show:!1,backup:null}),children:"Cancel"}),(0,t.jsxs)(o.$,{variant:"destructive",onClick:U,disabled:a.restore,children:[a.restore?(0,t.jsx)(i.A,{className:"h-4 w-4 animate-spin mr-2"}):null,"Restore Database"]})]})]})]})}),O.show&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,t.jsxs)(c.Zp,{className:"w-full max-w-md mx-4",children:[(0,t.jsx)(c.aR,{children:(0,t.jsx)(c.ZB,{className:"text-blue-600",children:"\uD83D\uDCC4 Confirm Database Settings Import"})}),(0,t.jsxs)(c.Wu,{className:"space-y-4",children:[(0,t.jsxs)("p",{children:["This will ",(0,t.jsx)("strong",{children:"restore database settings"})," from the JSON export:"]}),(0,t.jsxs)("div",{className:"bg-muted p-3 rounded",children:[(0,t.jsx)("p",{className:"font-medium",children:O.filename}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"JSON Export File"})]}),(0,t.jsxs)("p",{className:"text-yellow-600 text-sm",children:[(0,t.jsx)("strong",{children:"Warning:"})," This will replace your current database settings. Your current database will be backed up automatically before the import."]}),(0,t.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,t.jsx)(o.$,{variant:"outline",onClick:()=>z({show:!1,jsonData:null,filename:""}),children:"Cancel"}),(0,t.jsxs)(o.$,{onClick:W,disabled:a.restore,children:[a.restore?(0,t.jsx)(i.A,{className:"h-4 w-4 animate-spin mr-2"}):null,"Import Settings"]})]})]})]})})]})}var E=a(5339),R=a(1243),B=a(1284),L=a(446),T=a(7924);let M=(0,N.A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var O=a(9409);function z(){let{logs:e,fileInfo:s,availableLevels:a,selectedLevel:r,searchQuery:l,isLoading:m,error:u,setSelectedLevel:p,setSearchQuery:f,fetchLogs:g,fetchLogLevels:v,clearLogs:y,copyLogs:N,downloadLogs:w}=function(){let[e,s]=(0,n.useState)([]),[a,t]=(0,n.useState)(null),[r,i]=(0,n.useState)([]),[l,c]=(0,n.useState)("all"),[o,d]=(0,n.useState)(""),[m,u]=(0,n.useState)(!1),[x,p]=(0,n.useState)(""),f=(0,n.useCallback)(async()=>{u(!0),p("");try{let e=new URLSearchParams;l&&"all"!==l&&e.append("level",l),o&&e.append("search",o),e.append("limit","1000");let a=await fetch("".concat("","/api/v1/maintenance/logs?").concat(e)),n=await a.json();n.success?(s(n.logs||[]),t({total_lines:n.total_lines||0,filtered_lines:n.filtered_lines||0,file_size:n.file_size||0,file_modified:n.file_modified||""})):p(n.message||"Failed to load logs")}catch(e){console.error("Error fetching logs:",e),p("Error loading logs")}finally{u(!1)}},[l,o]),g=async()=>{try{let e=await fetch("".concat("","/api/v1/maintenance/logs/levels")),s=await e.json();s.success&&i(s.levels||[])}catch(e){console.error("Error fetching log levels:",e)}},b=(0,n.useCallback)(async()=>{try{let e=await fetch("".concat("","/api/v1/maintenance/logs/clear"),{method:"DELETE"}),s=await e.json();if(s.success)return await f(),h.oR.success("Logs cleared successfully"),!0;return h.oR.error("Failed to clear logs: ".concat(s.error||s.message||"Unknown error")),!1}catch(e){return console.error("Error clearing logs:",e),h.oR.error("Error clearing logs"),!1}},[f]),j=async()=>{if(e.length)try{let s=e.map(e=>"".concat(e.timestamp," - ").concat(e.level," - ").concat(e.message)).join("\n");await navigator.clipboard.writeText(s),h.oR.success("Logs copied to clipboard!")}catch(e){console.error("Error copying logs:",e),h.oR.error("Failed to copy logs to clipboard")}};return{logs:e,fileInfo:a,availableLevels:r,selectedLevel:l,searchQuery:o,isLoading:m,error:x,setSelectedLevel:c,setSearchQuery:d,fetchLogs:f,fetchLogLevels:g,clearLogs:b,copyLogs:j,downloadLogs:async()=>{try{let e=await fetch("".concat("","/api/v1/maintenance/logs/download"));if(e.ok){let s=await e.blob(),a=window.URL.createObjectURL(s),t=document.createElement("a");t.href=a,t.download="aphrodite-logs-".concat(new Date().toISOString().split("T")[0],".log"),document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(a),document.body.removeChild(t),h.oR.success("Logs downloaded successfully")}else h.oR.error("Failed to download logs")}catch(e){console.error("Error downloading logs:",e),h.oR.error("Error downloading logs")}}}}(),[k,A]=(0,n.useState)(!1);(0,n.useEffect)(()=>{v(),g()},[]),(0,n.useEffect)(()=>{g()},[g]);let S=e=>{switch(null==e?void 0:e.toLowerCase()){case"error":case"critical":return"bg-red-500/10 hover:bg-red-500/20";case"warning":return"bg-yellow-500/10 hover:bg-yellow-500/20";case"info":return"bg-blue-500/10 hover:bg-blue-500/20";case"debug":return"bg-purple-500/10 hover:bg-purple-500/20";default:return"hover:bg-muted"}},z=e=>{switch(null==e?void 0:e.toLowerCase()){case"error":case"critical":return(0,t.jsx)(E.A,{className:"h-3 w-3 text-red-500"});case"warning":return(0,t.jsx)(R.A,{className:"h-3 w-3 text-yellow-500"});case"info":return(0,t.jsx)(B.A,{className:"h-3 w-3 text-blue-500"});case"debug":return(0,t.jsx)(L.A,{className:"h-3 w-3 text-purple-500"});default:return(0,t.jsx)(_,{className:"h-3 w-3 text-muted-foreground"})}},J=e=>{switch(null==e?void 0:e.toLowerCase()){case"error":case"critical":return"destructive";case"warning":return"secondary";case"info":return"default";default:return"outline"}},I=()=>{g()},Z=async()=>{await y()&&A(!1)};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{children:[(0,t.jsxs)(c.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(_,{className:"h-5 w-5"}),"Application Logs"]}),(0,t.jsx)(c.BT,{children:"View, filter, and manage Aphrodite application logs"})]}),(0,t.jsxs)(c.Wu,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(j.J,{className:"text-sm font-medium",children:"Log Level"}),(0,t.jsxs)(O.l6,{value:r,onValueChange:p,children:[(0,t.jsx)(O.bq,{className:"w-40",children:(0,t.jsx)(O.yv,{placeholder:"All Levels"})}),(0,t.jsxs)(O.gC,{children:[(0,t.jsx)(O.eb,{value:"all",children:"All Levels"}),a.map(e=>(0,t.jsx)(O.eb,{value:e,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[z(e),e]})},e))]})]})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-48 space-y-2",children:[(0,t.jsx)(j.J,{className:"text-sm font-medium",children:"Search Messages"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(b.p,{placeholder:"Search log messages...",value:l,onChange:e=>f(e.target.value),onKeyPress:e=>{"Enter"===e.key&&I()},className:"flex-1"}),(0,t.jsx)(o.$,{variant:"outline",onClick:I,disabled:m,children:(0,t.jsx)(T.A,{className:"h-4 w-4"})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(j.J,{className:"text-sm font-medium",children:"Actions"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(o.$,{variant:"outline",onClick:g,disabled:m,size:"sm",children:m?(0,t.jsx)(i.A,{className:"h-4 w-4 animate-spin"}):(0,t.jsx)(x.A,{className:"h-4 w-4"})}),(0,t.jsx)(o.$,{variant:"outline",onClick:N,disabled:!e.length,size:"sm",children:(0,t.jsx)(M,{className:"h-4 w-4"})}),(0,t.jsx)(o.$,{variant:"outline",onClick:w,disabled:!e.length,size:"sm",children:(0,t.jsx)(C.A,{className:"h-4 w-4"})}),(0,t.jsx)(o.$,{variant:"outline",onClick:()=>A(!0),disabled:!e.length,size:"sm",children:(0,t.jsx)(D.A,{className:"h-4 w-4"})})]})]})]}),s&&(0,t.jsx)(c.Zp,{className:"bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-800",children:(0,t.jsx)(c.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:s.total_lines})," total lines",e.length!==s.total_lines&&(0,t.jsxs)("span",{className:"text-muted-foreground",children:[" ","(showing ",(0,t.jsx)("strong",{children:e.length})," filtered)"]})]}),(0,t.jsxs)("div",{className:"flex gap-4 text-muted-foreground",children:[(0,t.jsx)("span",{children:(e=>{if(!e)return"0 B";let s=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,s)).toFixed(+(s>0))+" "+["B","KB","MB","GB"][s]})(s.file_size)}),(0,t.jsxs)("span",{children:["Modified: ",new Date(s.file_modified).toLocaleString()]})]})]})})}),m&&(0,t.jsxs)("div",{className:"flex items-center justify-center p-8",children:[(0,t.jsx)(i.A,{className:"h-8 w-8 animate-spin mr-2"}),(0,t.jsx)("span",{children:"Loading logs..."})]}),u&&!m&&(0,t.jsx)(c.Zp,{className:"bg-red-50 dark:bg-red-950/20 border-red-200 dark:border-red-800",children:(0,t.jsxs)(c.Wu,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-red-600 dark:text-red-400",children:[(0,t.jsx)(E.A,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-medium",children:"Error loading logs"})]}),(0,t.jsx)("p",{className:"text-sm text-red-600 dark:text-red-400 mt-1",children:u})]})}),!e.length&&!m&&!u&&(0,t.jsx)(c.Zp,{className:"bg-muted/50",children:(0,t.jsxs)(c.Wu,{className:"p-8 text-center",children:[(0,t.jsx)(_,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No logs found"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:r&&"all"!==r||l?"Try adjusting your filters or search query.":"The log file is empty or doesn't exist yet."})]})}),e.length>0&&!m&&(0,t.jsxs)(c.Zp,{children:[(0,t.jsx)(c.aR,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(c.ZB,{className:"text-base",children:"Log Entries"}),(0,t.jsxs)(d.E,{variant:"outline",children:[e.length," ",1===e.length?"entry":"entries"]})]})}),(0,t.jsx)(c.Wu,{className:"p-0",children:(0,t.jsx)("div",{className:"max-h-96 overflow-auto border-t",children:e.map(e=>(0,t.jsxs)("div",{className:"flex items-start p-3 border-b last:border-b-0 font-mono text-sm transition-colors ".concat(S(e.level)),children:[(0,t.jsx)("span",{className:"text-xs text-muted-foreground w-12 flex-shrink-0 mr-3 mt-0.5",children:e.line_number}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground w-32 flex-shrink-0 mr-3 mt-0.5",children:e.timestamp}),(0,t.jsx)("div",{className:"w-20 flex-shrink-0 mr-3",children:(0,t.jsxs)(d.E,{variant:J(e.level),className:"text-xs font-bold flex items-center gap-1",children:[z(e.level),e.level]})}),(0,t.jsx)("span",{className:"flex-1 break-words leading-relaxed",children:e.message})]},e.line_number))})})]})]})]}),k&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,t.jsxs)(c.Zp,{className:"w-full max-w-md mx-4",children:[(0,t.jsx)(c.aR,{children:(0,t.jsx)(c.ZB,{className:"text-yellow-600",children:"Clear Logs"})}),(0,t.jsxs)(c.Wu,{className:"space-y-4",children:[(0,t.jsx)("p",{children:"Are you sure you want to clear all logs? This action cannot be undone."}),(0,t.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,t.jsx)(o.$,{variant:"outline",onClick:()=>A(!1),children:"Cancel"}),(0,t.jsx)(o.$,{variant:"destructive",onClick:Z,children:"Clear All Logs"})]})]})]})})]})}function J(){let[e,s]=(0,n.useState)("connection"),{loading:a,loadMaintenanceData:c}=function(){let[e,s]=(0,n.useState)(!1),[a,t]=(0,n.useState)(p),r=async()=>{s(!0);try{console.log("Loading maintenance page data...");let[e,s]=await Promise.all([fetch("".concat("","/api/v1/maintenance/database/status")),fetch("".concat("","/api/v1/maintenance/logs/levels"))]),a=await e.json(),n=await s.json();console.log("Loaded maintenance data:",{databaseData:a,logsLevelsData:n}),t(e=>({...e,databaseInfo:a.success?a:null,logsData:{...e.logsData,availableLevels:n.success?n.levels:[]}})),console.log("Maintenance page data loaded successfully")}catch(e){console.error("Error loading maintenance page data:",e),h.oR.error("Failed to load maintenance information",{description:e instanceof Error?e.message:"Unknown error occurred",duration:5e3})}finally{s(!1)}},i=async()=>{await r()};return{loading:e,data:a,loadMaintenanceData:r,refreshData:i,setData:t}}();return((0,n.useEffect)(()=>{c()},[]),a)?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(i.A,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Loading maintenance tools..."})]})}):(0,t.jsxs)("div",{className:"container mx-auto p-6 max-w-7xl",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)(l.A,{className:"h-8 w-8 text-primary"}),(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Maintenance"})]}),(0,t.jsx)("p",{className:"text-muted-foreground text-lg",children:"System management tools and diagnostics for Aphrodite v2"})]}),(0,t.jsxs)(r.tU,{value:e,onValueChange:s,className:"space-y-6",children:[(0,t.jsxs)(r.j7,{className:"grid w-full grid-cols-3",children:[(0,t.jsxs)(r.Xi,{value:"connection",className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"hidden sm:inline",children:"Connection Check"}),(0,t.jsx)("span",{className:"sm:hidden",children:"Connection"})]}),(0,t.jsxs)(r.Xi,{value:"database",className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"hidden sm:inline",children:"Database Operations"}),(0,t.jsx)("span",{className:"sm:hidden",children:"Database"})]}),(0,t.jsxs)(r.Xi,{value:"logs",className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"hidden sm:inline",children:"Logs"}),(0,t.jsx)("span",{className:"sm:hidden",children:"Logs"})]})]}),(0,t.jsx)(r.av,{value:"connection",className:"space-y-6",children:(0,t.jsx)(g,{})}),(0,t.jsx)(r.av,{value:"database",className:"space-y-6",children:(0,t.jsx)(S,{})}),(0,t.jsx)(r.av,{value:"logs",className:"space-y-6",children:(0,t.jsx)(z,{})})]})]})}},7313:(e,s,a)=>{"use strict";a.d(s,{Xi:()=>c,av:()=>o,j7:()=>l,tU:()=>i});var t=a(5155);a(2115);var n=a(704),r=a(9434);function i(e){let{className:s,...a}=e;return(0,t.jsx)(n.bL,{"data-slot":"tabs",className:(0,r.cn)("flex flex-col gap-2",s),...a})}function l(e){let{className:s,...a}=e;return(0,t.jsx)(n.B8,{"data-slot":"tabs-list",className:(0,r.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...a})}function c(e){let{className:s,...a}=e;return(0,t.jsx)(n.l9,{"data-slot":"tabs-trigger",className:(0,r.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...a})}function o(e){let{className:s,...a}=e;return(0,t.jsx)(n.UC,{"data-slot":"tabs-content",className:(0,r.cn)("flex-1 outline-none",s),...a})}},7924:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},8313:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(9946).A)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]])},9409:(e,s,a)=>{"use strict";a.d(s,{bq:()=>u,eb:()=>f,gC:()=>p,l6:()=>d,yv:()=>m});var t=a(5155),n=a(2115),r=a(2918),i=a(6474),l=a(7863),c=a(5196),o=a(9434);let d=r.bL;r.YJ;let m=r.WT,u=n.forwardRef((e,s)=>{let{className:a,children:n,...l}=e;return(0,t.jsxs)(r.l9,{ref:s,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[n,(0,t.jsx)(r.In,{asChild:!0,children:(0,t.jsx)(i.A,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=r.l9.displayName;let x=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(r.PP,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,t.jsx)(l.A,{className:"h-4 w-4"})})});x.displayName=r.PP.displayName;let h=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(r.wn,{ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,t.jsx)(i.A,{className:"h-4 w-4"})})});h.displayName=r.wn.displayName;let p=n.forwardRef((e,s)=>{let{className:a,children:n,position:i="popper",...l}=e;return(0,t.jsx)(r.ZL,{children:(0,t.jsxs)(r.UC,{ref:s,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,...l,children:[(0,t.jsx)(x,{}),(0,t.jsx)(r.LM,{className:(0,o.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,t.jsx)(h,{})]})})});p.displayName=r.UC.displayName,n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(r.JU,{ref:s,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...n})}).displayName=r.JU.displayName;let f=n.forwardRef((e,s)=>{let{className:a,children:n,...i}=e;return(0,t.jsxs)(r.q7,{ref:s,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(r.VF,{children:(0,t.jsx)(c.A,{className:"h-4 w-4"})})}),(0,t.jsx)(r.p4,{children:n})]})});f.displayName=r.q7.displayName,n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(r.wv,{ref:s,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...n})}).displayName=r.wv.displayName},9434:(e,s,a)=>{"use strict";a.d(s,{cn:()=>r});var t=a(2596),n=a(9688);function r(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,n.QP)((0,t.$)(s))}}},e=>{var s=s=>e(e.s=s);e.O(0,[455,671,904,433,438,950,441,684,358],()=>s(1931)),_N_E=e.O()}]);