(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[517],{1616:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>N});var r=a(5155),t=a(2115);let i={availableBadgeTypes:[{id:"audio",name:"Audio",description:"Audio codec badges (DTS-X, Atmos, etc.)"},{id:"resolution",name:"Resolution",description:"Resolution badges (4K, 1080p, etc.)"},{id:"review",name:"Review",description:"Review/rating badges (IMDb, TMDb, etc.)"},{id:"awards",name:"Awards",description:"Awards badges (Oscars, Emmys, etc.)"}],selectedBadgeTypes:["audio","resolution"],currentPreview:{isGenerating:!1},libraries:[],mediaItems:[],configuration:{selectedBadgeTypes:["audio","resolution"],previewOptions:{useExamplePoster:!0,overlayOpacity:.8,showBeforeAfter:!0}},processingQueue:{jobs:[],activeJobs:0,maxConcurrent:3,totalCompleted:0,totalFailed:0},isLoading:!1,activeTab:"simple"};var l=a(6671),n=a(6695),c=a(7262),o=a(285),d=a(6126),m=a(381),p=a(133);function x(e){let{availableBadgeTypes:s,selectedBadgeTypes:a,onToggleBadgeType:t,onGeneratePreview:i,isGenerating:l,className:x=""}=e;return(0,r.jsxs)(n.Zp,{className:x,children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(m.A,{className:"h-5 w-5"}),"Badge Configuration"]}),(0,r.jsx)(n.BT,{children:"Select which badges to apply to the preview poster. Aphrodite will use an example poster to demonstrate how badges look."})]}),(0,r.jsxs)(n.Wu,{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h4",{className:"text-sm font-medium",children:"Badge Types"}),(0,r.jsxs)(d.E,{variant:"secondary",className:"text-xs",children:[a.length," selected"]})]}),(0,r.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsx)(c.S,{id:"badge-".concat(e.id),checked:a.includes(e.id),onCheckedChange:()=>t(e.id),className:"mt-0.5"}),(0,r.jsxs)("div",{className:"grid gap-1.5 leading-none",children:[(0,r.jsx)("label",{htmlFor:"badge-".concat(e.id),className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.id))})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(o.$,{onClick:i,disabled:l||0===a.length,className:"w-full",size:"lg",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent"}),"Generating Preview..."]}):"Generate Preview"}),(0,r.jsxs)(o.$,{variant:"outline",onClick:()=>{let e=["audio","resolution"];a.forEach(s=>{e.includes(s)||t(s)}),e.forEach(e=>{a.includes(e)||t(e)})},disabled:l,className:"w-full",size:"sm",children:[(0,r.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Reset to Defaults"]})]}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground space-y-1",children:[(0,r.jsx)("p",{children:"• Preview uses realistic demo data for consistent results"}),(0,r.jsx)("p",{children:"• All badge settings from Settings page are applied"}),(0,r.jsx)("p",{children:"• Select at least one badge type to generate preview"})]})]})]})}var u=a(5339),h=a(7213),g=a(1981),v=a(1788),w=a(3786),j=a(5365),f=a(4165);function y(e){let{isGenerating:s,previewUrl:a,sourcePoster:i,selectedBadgeTypes:l,error:c,className:m=""}=e,[p,x]=(0,t.useState)(!1),[y,N]=(0,t.useState)(!1),b=e=>{if(!e)return e;let s=e.includes("?")?"&":"?";return"".concat(e).concat(s,"t=").concat(Date.now())},P=async()=>{if(a)try{let e=await fetch(a),s=await e.blob(),r=window.URL.createObjectURL(s),t=document.createElement("a");t.href=r,t.download="aphrodite-preview-".concat(Date.now(),".png"),document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(r),document.body.removeChild(t)}catch(e){console.error("Error downloading preview:",e)}};return(0,r.jsxs)(n.Zp,{className:m,children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(h.A,{className:"h-5 w-5"}),"Preview Poster"]}),(0,r.jsx)(n.BT,{children:"See how your selected badges will look on a poster"})]}),(0,r.jsx)(n.Wu,{children:c?(0,r.jsxs)(j.Fc,{variant:"destructive",children:[(0,r.jsx)(u.A,{className:"h-4 w-4"}),(0,r.jsx)(j.TN,{children:c})]}):s?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 space-y-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"h-16 w-16 animate-spin rounded-full border-4 border-muted border-t-primary"}),(0,r.jsx)(h.A,{className:"absolute top-1/2 left-1/2 h-6 w-6 -translate-x-1/2 -translate-y-1/2 text-muted-foreground"})]}),(0,r.jsxs)("div",{className:"text-center space-y-2",children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:"Generating preview..."}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Applying ",l.length," badge type",1!==l.length?"s":""]})]})]}):a&&!p?(console.log("\uD83D\uDDBC️ Rendering image with URL:",a),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"relative group",children:[(0,r.jsx)("img",{src:b(a),alt:"Preview Poster",className:"w-full h-auto rounded-lg shadow-md transition-transform group-hover:scale-[1.02]",style:{maxHeight:"500px",objectFit:"contain"},onError:()=>{console.error("\uD83D\uDDBC️ Image failed to load:",a),x(!0)},onLoad:()=>{console.log("\uD83D\uDDBC️ Image loaded successfully:",a),x(!1)},crossOrigin:"anonymous"}),(0,r.jsxs)("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity space-x-2",children:[(0,r.jsxs)(f.lG,{open:y,onOpenChange:N,children:[(0,r.jsx)(f.zM,{asChild:!0,children:(0,r.jsx)(o.$,{size:"sm",variant:"secondary",className:"backdrop-blur-sm",children:(0,r.jsx)(g.A,{className:"h-4 w-4"})})}),(0,r.jsxs)(f.Cf,{className:"max-w-4xl w-full h-[90vh]",children:[(0,r.jsxs)(f.c7,{children:[(0,r.jsx)(f.L3,{children:"Preview Poster - Full Size"}),(0,r.jsxs)(f.rr,{children:["Enhanced with ",l.join(", ")," badges",i&&' using "'.concat(i,'"')]})]}),(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center overflow-auto",children:(0,r.jsx)("img",{src:b(a),alt:"Preview Poster - Full Size",className:"max-w-full max-h-full object-contain",crossOrigin:"anonymous"})})]})]}),(0,r.jsx)(o.$,{size:"sm",variant:"secondary",onClick:P,className:"backdrop-blur-sm",children:(0,r.jsx)(v.A,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)("div",{className:"text-center space-y-2",children:[(0,r.jsx)("div",{className:"flex flex-wrap gap-1 justify-center",children:l.map(e=>(0,r.jsx)(d.E,{variant:"secondary",className:"text-xs",children:e},e))}),(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Preview generated with ",l.length," badge type",1!==l.length?"s":"",i&&(0,r.jsxs)("span",{className:"block text-xs mt-1",children:['Using "',i,'"']})]})]}),(0,r.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,r.jsxs)(o.$,{variant:"outline",size:"sm",onClick:P,children:[(0,r.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Download Preview"]}),(0,r.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>N(!0),children:[(0,r.jsx)(w.A,{className:"mr-2 h-4 w-4"}),"View Full Size"]})]})]})):(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 space-y-4",children:[(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)(h.A,{className:"h-16 w-16 text-muted-foreground/30"})}),(0,r.jsxs)("div",{className:"text-center space-y-2",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Your poster preview will appear here"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:'Select badge types and click "Generate Preview"'})]})]})})]})}function N(){let{loading:e,data:s,loadPreviewData:a}=function(){let[e,s]=(0,t.useState)(!1),[a,r]=(0,t.useState)(i),n=async()=>{s(!0);try{console.log("Loading preview page data...");let e=await fetch("".concat("","/api/v1/preview/badge-types")),s=await e.json();console.log("Loaded preview data:",{badgeTypesData:s}),r(e=>({...e,availableBadgeTypes:s.success?s.badgeTypes:i.availableBadgeTypes})),console.log("Preview page data loaded successfully")}catch(e){console.error("Error loading preview page data:",e),l.oR.error("Failed to load preview information",{description:e instanceof Error?e.message:"Unknown error occurred",duration:5e3})}finally{s(!1)}},c=async()=>{await n()};return{loading:e,data:a,loadPreviewData:n,refreshData:c,setData:r}}(),{selectedBadgeTypes:n,isGenerating:c,currentPreview:o,generatePreview:d,toggleBadgeType:m}=function(){let[e,s]=(0,t.useState)(["audio","resolution"]),[a,r]=(0,t.useState)(!1),[i,n]=(0,t.useState)({}),c=async()=>{if(0===e.length)return l.oR.error("Please select at least one badge type"),!1;r(!0),n({error:void 0,previewUrl:void 0});try{let a=await fetch("".concat("","/api/v1/preview/generate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({badgeTypes:e})}),r=await a.json();if(!r.success)return n({error:r.message||"Failed to generate preview"}),l.oR.error(r.message||"Failed to generate preview"),!1;{var s;console.log("\uD83C\uDFA8 Preview generation successful:",r),console.log("\uD83D\uDDBC️ Setting preview URL:",r.posterUrl),n({previewUrl:r.posterUrl,sourcePoster:"Random Selection",error:void 0});let a=(null==(s=r.appliedBadges)?void 0:s.length)||e.length,t=r.processingTime||0;return l.oR.success("Preview generated with ".concat(a," badges (").concat(t.toFixed(2),"s)")),!0}}catch(s){console.error("Error generating preview:",s);let e=s instanceof Error?s.message:"Failed to generate preview";return n({error:e}),l.oR.error(e),!1}finally{r(!1)}};return{selectedBadgeTypes:e,isGenerating:a,currentPreview:i,generatePreview:c,toggleBadgeType:e=>{s(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},clearPreview:()=>{n({})},setSelectedBadgeTypes:s}}();return(0,t.useEffect)(()=>{a()},[]),(0,r.jsxs)("div",{className:"container mx-auto py-6 space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Preview"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Generate poster previews with badges to see how they'll look before applying changes"})]}),(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsx)(x,{availableBadgeTypes:s.availableBadgeTypes,selectedBadgeTypes:n,onToggleBadgeType:m,onGeneratePreview:d,isGenerating:c})}),(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsx)(y,{isGenerating:c,previewUrl:o.previewUrl,sourcePoster:o.sourcePoster,selectedBadgeTypes:n,error:o.error})})]})})]})}a(2523),a(9409),a(4944),a(2346)},7400:(e,s,a)=>{Promise.resolve().then(a.bind(a,1616))}},e=>{var s=s=>e(e.s=s);e.O(0,[455,671,904,433,106,523,369,441,684,358],()=>s(7400)),_N_E=e.O()}]);