(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[128,722],{722:(e,s,t)=>{"use strict";t.d(s,{A:()=>c,apiService:()=>n});let a=()=>window.location.origin,l=e=>{let s=a();return"".concat(s).concat(e)};class r extends Error{constructor(e,s,t){super(e),this.status=s,this.response=t,this.name="ApiError"}}async function i(e){if(console.log("\uD83C\uDF10 API Response: ".concat(e.status," ").concat(e.url)),!e.ok){let s="HTTP ".concat(e.status,": ").concat(e.statusText);try{let t=await e.json();s=t.error||t.message||s}catch(e){}throw console.error("❌ API Error: ".concat(s," (").concat(e.url,")")),new r(s,e.status)}try{let s=await e.json();return console.log("✅ API Success: ".concat(e.url)),s}catch(s){return console.log("⚠️ API No JSON: ".concat(e.url)),{}}}let n={getConfig:async e=>i(await fetch(l("/api/v1/config/".concat(e)))),updateConfig:async(e,s)=>i(await fetch(l("/api/v1/config/".concat(e)),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})),getConfigFiles:async()=>i(await fetch(l("/api/v1/config/files"))),testJellyfinConnection:async e=>i(await fetch(l("/api/v1/config/test-jellyfin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),testConnection:async(e,s)=>i(await fetch(l("/api/v1/config/test-".concat(e)),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})),getSystemStatus:async()=>i(await fetch(l("/health/detailed"))),getSystemInfo:async()=>i(await fetch(l("/api/v1/system/info"))),getSystemConfig:async()=>i(await fetch(l("/api/v1/config/system"))),getPreviewBadgeTypes:async()=>i(await fetch(l("/api/v1/preview/badge-types"))),generatePreview:async e=>i(await fetch(l("/api/v1/preview/generate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),getPreviewLibraries:async()=>i(await fetch(l("/api/v1/preview/libraries"))),async getPreviewMedia(e){let s=new URLSearchParams;(null==e?void 0:e.library_id)&&s.set("library_id",e.library_id),(null==e?void 0:e.search)&&s.set("search",e.search),(null==e?void 0:e.page)&&s.set("page",e.page.toString()),(null==e?void 0:e.limit)&&s.set("limit",e.limit.toString());let t=l("/api/v1/preview/media".concat(s.toString()?"?"+s.toString():""));return i(await fetch(t))},async getMedia(e){let s=new URLSearchParams;(null==e?void 0:e.page)&&s.set("page",e.page.toString()),(null==e?void 0:e.per_page)&&s.set("per_page",e.per_page.toString()),(null==e?void 0:e.search)&&s.set("search",e.search),(null==e?void 0:e.media_type)&&s.set("media_type",e.media_type);let t=l("/api/v1/media".concat(s.toString()?"?"+s.toString():""));return i(await fetch(t))},getMediaItem:async e=>i(await fetch(l("/api/v1/media/".concat(e)))),scanLibrary:async()=>i(await fetch(l("/api/v1/media/scan"),{method:"POST"})),async getJobs(e){let s=new URLSearchParams;(null==e?void 0:e.user_id)&&s.set("user_id",e.user_id);let t=l("/api/v1/workflow/jobs/".concat(s.toString()?"?"+s.toString():""));return i(await fetch(t))},createJob:async e=>i(await fetch(l("/api/v1/jobs"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),getJob:async e=>i(await fetch(l("/api/v1/workflow/jobs/".concat(e)))),async getSchedules(e){let s=new URLSearchParams;(null==e?void 0:e.skip)&&s.set("skip",e.skip.toString()),(null==e?void 0:e.limit)&&s.set("limit",e.limit.toString());let t=l("/api/v1/schedules".concat(s.toString()?"?"+s.toString():""));return i(await fetch(t))},createSchedule:async e=>i(await fetch(l("/api/v1/schedules"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})),updateSchedule:async(e,s)=>i(await fetch(l("/api/v1/schedules/".concat(e)),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})),deleteSchedule:async e=>i(await fetch(l("/api/v1/schedules/".concat(e)),{method:"DELETE"})),async getScheduleHistory(e){let s=new URLSearchParams;(null==e?void 0:e.skip)&&s.set("skip",e.skip.toString()),(null==e?void 0:e.limit)&&s.set("limit",e.limit.toString()),(null==e?void 0:e.schedule_id)&&s.set("schedule_id",e.schedule_id),(null==e?void 0:e.status)&&s.set("status",e.status);let t=l("/api/v1/schedules/executions/history".concat(s.toString()?"?"+s.toString():""));return i(await fetch(t))},executeSchedule:async e=>i(await fetch(l("/api/v1/schedules/".concat(e,"/execute")),{method:"POST"})),getScheduleBadgeTypes:async()=>i(await fetch(l("/api/v1/schedules/config/badge-types"))),getScheduleCronPresets:async()=>i(await fetch(l("/api/v1/schedules/config/cron-presets"))),getScheduleLibraries:async()=>i(await fetch(l("/api/v1/schedules/config/libraries"))),getAnalyticsOverview:async()=>i(await fetch(l("/api/v1/analytics/overview"))),getJobStatusDistribution:async()=>i(await fetch(l("/api/v1/analytics/jobs/status-distribution"))),async getProcessingTrends(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;return i(await fetch(l("/api/v1/analytics/jobs/trends?days=".concat(e))))},getJobTypeDistribution:async()=>i(await fetch(l("/api/v1/analytics/jobs/types"))),getScheduleAnalytics:async()=>i(await fetch(l("/api/v1/analytics/schedules"))),getSystemPerformance:async()=>i(await fetch(l("/api/v1/analytics/performance")))},c=n},5057:(e,s,t)=>{"use strict";t.d(s,{J:()=>i});var a=t(5155);t(2115);var l=t(968),r=t(9434);function i(e){let{className:s,...t}=e;return(0,a.jsx)(l.b,{"data-slot":"label",className:(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...t})}},6304:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ek});var a=t(5155),l=t(2115),r=t(7313),i=t(6126),n=t(9409),c=t(6695),o=t(1066),d=t(6618),m=t(8719),u=t(1154);function h(e){let{libraries:s,selectedLibrary:t,onLibraryChange:l,loading:r}=e,h=e=>{switch(e.toLowerCase()){case"movies":return(0,a.jsx)(o.A,{className:"h-4 w-4"});case"tvshows":return(0,a.jsx)(d.A,{className:"h-4 w-4"});default:return(0,a.jsx)(m.A,{className:"h-4 w-4"})}};return r&&0===s.length?(0,a.jsx)(c.Zp,{children:(0,a.jsxs)(c.Wu,{className:"flex items-center justify-center py-6",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 animate-spin mr-2"}),(0,a.jsx)("span",{children:"Loading libraries..."})]})}):0===s.length?(0,a.jsx)(c.Zp,{children:(0,a.jsxs)(c.Wu,{className:"flex flex-col items-center justify-center py-6",children:[(0,a.jsx)(m.A,{className:"h-8 w-8 text-muted-foreground mb-2"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"No media libraries found"})]})}):(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsxs)(c.ZB,{className:"flex items-center space-x-2",children:[(0,a.jsx)(m.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Select Library"})]}),(0,a.jsx)(c.BT,{children:"Choose a Jellyfin library to browse and manage posters"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsxs)(n.l6,{value:t,onValueChange:l,children:[(0,a.jsx)(n.bq,{children:(0,a.jsx)(n.yv,{placeholder:"Select a library..."})}),(0,a.jsx)(n.gC,{children:s.map(e=>(0,a.jsx)(n.eb,{value:e.id,children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[h(e.type),(0,a.jsx)("span",{children:e.name}),(0,a.jsx)(i.E,{variant:"outline",children:e.type})]})},e.id))})]})})]})}var x=t(7262),p=t(8009),g=t(9074),j=t(9509);function f(){return"".concat(window.location.protocol,"//").concat(window.location.host)}function v(e){return!e||e.startsWith("http://")||e.startsWith("https://")?e:e.startsWith("/")?"".concat(f()).concat(e):"".concat(f(),"/").concat(e)}function b(e){let{item:s,isSelected:t=!1,onSelectionChange:r,selectionMode:n=!1,onPosterClick:o}=e,[d,m]=(0,l.useState)(!1),[u,h]=(0,l.useState)(!0),j=e=>{r&&r(s.id,e)};return(0,a.jsx)(c.Zp,{className:"group hover:shadow-lg transition-all duration-200 ".concat(t?"ring-2 ring-blue-500 bg-blue-50 dark:bg-blue-950":""," ").concat(n?"cursor-pointer hover:ring-2 hover:ring-blue-300":"cursor-pointer"),onClick:e=>{n?(e.preventDefault(),j(!t)):o&&o(s)},children:(0,a.jsxs)(c.Wu,{className:"p-0 relative",children:[n&&(0,a.jsx)("div",{className:"absolute top-2 right-2 z-20",children:(0,a.jsx)("div",{className:"bg-white/90 rounded p-1 shadow-sm cursor-pointer",onClick:e=>{e.preventDefault(),e.stopPropagation(),j(!t)},children:(0,a.jsx)(x.S,{checked:t,onCheckedChange:j,className:"pointer-events-none"})})}),(0,a.jsxs)("div",{className:"relative aspect-[2/3] bg-muted rounded-t-lg overflow-hidden",children:[s.poster_url&&!d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{src:v(s.poster_url),alt:s.title,className:"w-full h-full object-cover transition-transform duration-200 group-hover:scale-105",onLoad:()=>h(!1),onError:()=>{m(!0),h(!1)}},s.poster_url),u&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-muted",children:(0,a.jsx)("div",{className:"animate-pulse",children:(0,a.jsx)(p.A,{className:"h-8 w-8 text-muted-foreground"})})})]}):(0,a.jsx)("div",{className:"flex items-center justify-center h-full bg-muted",children:(0,a.jsx)(p.A,{className:"h-12 w-12 text-muted-foreground"})}),(0,a.jsx)("div",{className:"absolute top-2 left-2",children:(0,a.jsx)(i.E,{variant:"BADGED"===s.badge_status?"destructive":"secondary",className:"text-xs",children:s.badge_status})})]}),(0,a.jsxs)("div",{className:"p-3 space-y-2",children:[(0,a.jsx)("h3",{className:"font-medium text-sm line-clamp-2 leading-tight",children:s.title}),s.year&&(0,a.jsxs)("div",{className:"flex items-center text-xs text-muted-foreground",children:[(0,a.jsx)(g.A,{className:"h-3 w-3 mr-1"}),s.year]}),s.genres.length>0&&(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[s.genres.slice(0,2).map(e=>(0,a.jsx)(i.E,{variant:"outline",className:"text-xs px-1 py-0",children:e},e)),s.genres.length>2&&(0,a.jsxs)(i.E,{variant:"outline",className:"text-xs px-1 py-0",children:["+",s.genres.length-2]})]})]})]})})}function N(e){let{items:s,loading:t,selectedItems:l=new Set,onSelectionChange:r,selectionMode:i=!1,onPosterClick:n}=e;return t?(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"flex items-center justify-center py-10",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(u.A,{className:"h-6 w-6 animate-spin"}),(0,a.jsx)("span",{children:"Loading posters..."})]})})}):0===s.length?(0,a.jsx)(c.Zp,{children:(0,a.jsxs)(c.Wu,{className:"flex flex-col items-center justify-center py-10",children:[(0,a.jsx)(p.A,{className:"h-12 w-12 text-muted-foreground mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No items found"}),(0,a.jsx)("p",{className:"text-muted-foreground text-center",children:"Try adjusting your search criteria or filters"})]})}):(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:s.map(e=>(0,a.jsx)(b,{item:e,isSelected:l.has(e.id),onSelectionChange:r,selectionMode:i,onPosterClick:n},e.id))})}"true"===j.env.DOCKER_ENV||"true"===j.env.IS_DOCKER||j.env.DOCKER_CONTAINER;var w=t(2523),y=t(285),S=t(7924),C=t(4416);function _(e){let{searchQuery:s,onSearchChange:t,badgeFilter:l,onBadgeFilterChange:r,onClearFilters:i}=e,o=s||"all"!==l;return(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(S.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(w.p,{placeholder:"Search by title...",value:s,onChange:e=>t(e.target.value),className:"pl-10"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,a.jsxs)(n.l6,{value:l,onValueChange:r,children:[(0,a.jsx)(n.bq,{className:"w-[160px]",children:(0,a.jsx)(n.yv,{placeholder:"Badge Status"})}),(0,a.jsxs)(n.gC,{children:[(0,a.jsx)(n.eb,{value:"all",children:"All Items"}),(0,a.jsx)(n.eb,{value:"badged",children:"Badged Only"}),(0,a.jsx)(n.eb,{value:"original",children:"Original Only"})]})]}),o&&(0,a.jsxs)(y.$,{variant:"outline",size:"sm",onClick:i,children:[(0,a.jsx)(C.A,{className:"h-4 w-4 mr-2"}),"Clear"]})]})]})})})}var k=t(2346),A=t(1539),D=t(7580),E=t(1788),P=t(381),T=t(3904),R=t(6932),J=t(2118),F=t(4944),O=t(5339),L=t(4186);let I=e=>{let{progress:s,isConnected:t,className:r=""}=e;return(0,l.useEffect)(()=>{console.log("\uD83D\uDCCA ProgressBar received progress update:",s)},[s]),(0,l.useEffect)(()=>{console.log("\uD83D\uDD17 ProgressBar connection status:",t)},[t]),(0,a.jsxs)("div",{className:"space-y-2 ".concat(r),children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(F.k,{value:s.progress_percentage,className:"h-2"}),(0,a.jsx)("div",{className:"absolute top-0 left-0 h-2 rounded transition-all ".concat(t?s.failed_posters>0?"bg-orange-500":100===s.progress_percentage?"bg-green-500":"bg-blue-500":"bg-gray-400"),style:{width:"".concat(s.progress_percentage,"%")}})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("span",{className:"font-medium",children:[s.completed_posters," / ",s.total_posters," completed"]}),s.failed_posters>0&&(0,a.jsxs)(i.E,{variant:"destructive",className:"text-xs",children:[(0,a.jsx)(O.A,{className:"w-3 h-3 mr-1"}),s.failed_posters," failed"]}),(0,a.jsxs)(i.E,{variant:t?"secondary":"outline",className:"text-xs",children:[(0,a.jsx)("div",{className:"w-2 h-2 rounded-full mr-1 ".concat(t?"bg-green-500":"bg-gray-400")}),t?"Live":"Disconnected"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(L.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["ETA: ",(e=>{if(!e)return"Calculating...";try{return new Date(e).toLocaleTimeString()}catch(e){return"Unknown"}})(s.estimated_completion)]})]})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("span",{className:"text-lg font-semibold",children:[s.progress_percentage.toFixed(1),"%"]})})]})};var B=t(2178),W=t(5690),$=t(8979);let z=e=>{let[s,t]=(0,l.useState)({isPausing:!1,isResuming:!1,isCancelling:!1}),a=(0,l.useCallback)(async(s,a)=>{t(e=>({...e,[a]:!0}));try{let t=await fetch("/api/v1/workflow/control/".concat(e,"/").concat(s),{method:"POST",headers:{"Content-Type":"application/json"}});if(t.ok)return!0;return console.error("Failed to ".concat(s," job:"),t.statusText),!1}catch(e){return console.error("Error ".concat(s,"ing job:"),e),!1}finally{t(e=>({...e,[a]:!1}))}},[e]),r=(0,l.useCallback)(()=>a("pause","isPausing"),[a]),i=(0,l.useCallback)(()=>a("resume","isResuming"),[a]),n=(0,l.useCallback)(()=>a("cancel","isCancelling"),[a]);return{...s,pauseJob:r,resumeJob:i,cancelJob:n}},M=e=>{let{jobId:s,jobStatus:t,onStatusChange:l,disabled:r=!1}=e,{isPausing:i,isResuming:n,isCancelling:c,pauseJob:o,resumeJob:d,cancelJob:m}=z(s),h=async()=>{await o()&&l&&l("paused")},x=async()=>{await d()&&l&&l("processing")},p=async()=>{await m()&&l&&l("cancelled")},g=i||n||c,j="processing"===t,f="paused"===t,v=["completed","failed","cancelled"].includes(t);return v?(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Job ",t]}):(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[j&&(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:h,disabled:r||g,children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"w-4 h-4 mr-1 animate-spin"}),"Pausing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(B.A,{className:"w-4 h-4 mr-1"}),"Pause"]})}),f&&(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:x,disabled:r||g,children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"w-4 h-4 mr-1 animate-spin"}),"Resuming..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.A,{className:"w-4 h-4 mr-1"}),"Resume"]})}),!v&&(0,a.jsx)(y.$,{variant:"destructive",size:"sm",onClick:p,disabled:r||g,children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"w-4 h-4 mr-1 animate-spin"}),"Cancelling..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($.A,{className:"w-4 h-4 mr-1"}),"Cancel"]})})]})},U=e=>{let[s,t]=(0,l.useState)(null),[a,r]=(0,l.useState)(!1),[i,n]=(0,l.useState)(null),c=(0,l.useRef)(null),o=(0,l.useRef)(null),d=(0,l.useCallback)(()=>{if(!e)return void console.log("❌ No jobId provided to useJobProgress hook");console.log("\uD83D\uDD0C Attempting WebSocket connection for job: ".concat(e));try{let s="https:"===window.location.protocol?"wss:":"ws:",a=window.location.host,l="".concat(s,"//").concat(a,"/api/v1/workflow/ws/").concat(e);console.log("\uD83D\uDD17 Connecting to: ".concat(l));let i=new WebSocket(l);c.current=i,i.onopen=()=>{r(!0),n(null),console.log("✅ WebSocket connected successfully for job ".concat(e))},i.onmessage=s=>{console.log("\uD83D\uDCE8 WebSocket message received for job ".concat(e,":"),s.data);try{let e=JSON.parse(s.data);console.log("\uD83D\uDCCA Parsed progress update:",e),"progress_update"===e.type&&(console.log("\uD83D\uDD04 Setting progress state:",e.data),t(e.data))}catch(e){console.error("❌ Failed to parse WebSocket message:",e)}},i.onclose=s=>{r(!1),console.log("\uD83D\uDD0C WebSocket disconnected for job ".concat(e),s.code,s.reason),t(null),1e3!==s.code&&1001!==s.code&&(console.log("\uD83D\uDD04 Scheduling reconnection for job ".concat(e)),o.current=setTimeout(()=>{var s;(null==(s=c.current)?void 0:s.readyState)===WebSocket.CLOSED&&(console.log("\uD83D\uDD04 Attempting to reconnect WebSocket for job ".concat(e)),d())},3e3))},i.onerror=s=>{n("WebSocket connection error"),r(!1),console.error("❌ WebSocket error for job ".concat(e,":"),s)}}catch(s){n("Failed to connect to job progress"),console.error("❌ WebSocket connection failed for job ".concat(e,":"),s)}},[e]),m=(0,l.useCallback)(()=>{o.current&&(clearTimeout(o.current),o.current=null),c.current&&(c.current.close(),c.current=null),r(!1)},[]),u=(0,l.useCallback)(()=>{m(),d()},[d,m]);return(0,l.useEffect)(()=>(d(),m),[d,m]),{progress:s,isConnected:a,error:i,reconnect:u}},Z=e=>{var s;let{job:t,onJobUpdate:r,onProgressUpdate:n}=e,[o,d]=(0,l.useState)(t.status),{progress:m,isConnected:u,error:h}=U(t.job_id);(0,l.useEffect)(()=>{console.log("\uD83C\uDFAF JobStatusCard for ".concat(t.job_id,": progress updated:"),m)},[m,t.job_id]),(0,l.useEffect)(()=>{console.log("\uD83D\uDD17 JobStatusCard for ".concat(t.job_id,": connection status:"),u)},[u,t.job_id]),(0,l.useEffect)(()=>{if(m&&n&&u){console.log("\uD83D\uDCE4 JobStatusCard sending progress update to parent for job ".concat(t.job_id,":"),m);let e=setTimeout(()=>{n(t.job_id,m)},100);return()=>clearTimeout(e)}m&&!u&&console.log("⚠️ JobStatusCard has progress data but WebSocket disconnected for job ".concat(t.job_id," - not sending stale data"))},[null==m?void 0:m.completed_posters,null==m?void 0:m.failed_posters,null==m?void 0:m.total_posters,t.job_id,n,u]);let x=m||{total_posters:t.total_posters,completed_posters:t.completed_posters,failed_posters:t.failed_posters,progress_percentage:t.total_posters>0?(t.completed_posters+t.failed_posters)/t.total_posters*100:0,estimated_completion:t.estimated_completion};return(0,a.jsxs)(c.Zp,{className:"w-full",children:[(0,a.jsxs)(c.aR,{className:"pb-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(c.ZB,{className:"text-lg",children:t.name}),(0,a.jsx)(i.E,{className:"".concat((e=>{switch(e){case"completed":return"bg-green-500";case"processing":return"bg-blue-500";case"paused":return"bg-yellow-500";case"failed":return"bg-red-500";case"cancelled":return"bg-gray-500";case"queued":return"bg-purple-500";default:return"bg-gray-400"}})(o)," text-white"),children:o})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(J.A,{className:"w-4 h-4 mr-1"}),t.total_posters," posters"]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(D.A,{className:"w-4 h-4 mr-1"}),(null==(s=t.badge_types)?void 0:s.join(", "))||"Unknown badges"]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(g.A,{className:"w-4 h-4 mr-1"}),(e=>{try{return new Date(e).toLocaleString()}catch(e){return"Unknown"}})(t.created_at)]})]})]}),(0,a.jsxs)(c.Wu,{className:"space-y-4",children:[["processing","paused"].includes(o)&&(0,a.jsx)(I,{progress:x,isConnected:u}),h&&(0,a.jsxs)("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:["Connection error: ",h]}),"completed"===o&&(0,a.jsxs)("div",{className:"text-center text-green-600 font-medium",children:["✅ All ",t.total_posters," posters processed successfully"]}),"failed"===o&&(0,a.jsxs)("div",{className:"text-center text-red-600 font-medium",children:["❌ Job failed - ",t.failed_posters," posters could not be processed"]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["ID: ",t.job_id.slice(0,8),"..."]}),(0,a.jsx)(M,{jobId:t.job_id,jobStatus:o,onStatusChange:e=>{d(e),null==r||r(t.job_id,e)}})]})]})]})},G=e=>{let{className:s=""}=e,[t,r]=(0,l.useState)([]),[i,o]=(0,l.useState)(!0),[d,m]=(0,l.useState)(""),[u,h]=(0,l.useState)("all"),[x,p]=(0,l.useState)(null),g=async()=>{try{o(!0);let e=await fetch("/api/v1/workflow/jobs/");if(e.ok){let s=await e.json();r(s||[]),p(null)}else p("Failed to fetch jobs")}catch(e){p("Network error while fetching jobs"),console.error("Error fetching jobs:",e)}finally{o(!1)}};(0,l.useEffect)(()=>{g()},[]);let j=(e,s)=>{r(t=>t.map(t=>t.job_id===e?{...t,status:s}:t))},f=(0,l.useCallback)((e,s)=>{console.log("\uD83D\uDCE5 JobsTab received progress update for job ".concat(e,":"),s),r(t=>t.map(t=>t.job_id===e?(console.log("\uD83D\uDD04 JobsTab updating job ".concat(e," with progress data")),{...t,completed_posters:s.completed_posters,failed_posters:s.failed_posters,total_posters:s.total_posters,estimated_completion:s.estimated_completion}):t))},[]),v=t.filter(e=>{let s=e.name.toLowerCase().includes(d.toLowerCase())||e.job_id.toLowerCase().includes(d.toLowerCase()),t="all"===u||e.status===u;return s&&t}),b=(()=>{let e=t.reduce((e,s)=>(e[s.status]=(e[s.status]||0)+1,e),{});return{all:t.length,...e}})();return i?(0,a.jsxs)("div",{className:"flex justify-center items-center h-64 ".concat(s),children:[(0,a.jsx)(T.A,{className:"w-8 h-8 animate-spin text-muted-foreground"}),(0,a.jsx)("span",{className:"ml-2 text-muted-foreground",children:"Loading jobs..."})]}):(0,a.jsxs)("div",{className:"space-y-6 ".concat(s),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Background Jobs"}),(0,a.jsxs)(y.$,{onClick:g,variant:"outline",size:"sm",children:[(0,a.jsx)(T.A,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsx)(c.aR,{children:(0,a.jsx)(c.ZB,{className:"text-lg",children:"Filter Jobs"})}),(0,a.jsx)(c.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(S.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),(0,a.jsx)(w.p,{placeholder:"Search by job name or ID...",value:d,onChange:e=>m(e.target.value),className:"pl-10"})]})}),(0,a.jsx)("div",{className:"w-48",children:(0,a.jsxs)(n.l6,{value:u,onValueChange:h,children:[(0,a.jsxs)(n.bq,{children:[(0,a.jsx)(R.A,{className:"w-4 h-4 mr-2"}),(0,a.jsx)(n.yv,{placeholder:"Filter by status"})]}),(0,a.jsxs)(n.gC,{children:[(0,a.jsxs)(n.eb,{value:"all",children:["All (",b.all,")"]}),(0,a.jsxs)(n.eb,{value:"processing",children:["Processing (",b.processing||0,")"]}),(0,a.jsxs)(n.eb,{value:"paused",children:["Paused (",b.paused||0,")"]}),(0,a.jsxs)(n.eb,{value:"completed",children:["Completed (",b.completed||0,")"]}),(0,a.jsxs)(n.eb,{value:"failed",children:["Failed (",b.failed||0,")"]}),(0,a.jsxs)(n.eb,{value:"cancelled",children:["Cancelled (",b.cancelled||0,")"]}),(0,a.jsxs)(n.eb,{value:"queued",children:["Queued (",b.queued||0,")"]})]})]})})]})})]}),x&&(0,a.jsx)(c.Zp,{className:"border-red-200",children:(0,a.jsx)(c.Wu,{className:"pt-6",children:(0,a.jsx)("div",{className:"text-red-600 text-center",children:x})})}),(0,a.jsx)("div",{className:"space-y-4",children:0===v.length?(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"pt-6",children:(0,a.jsx)("div",{className:"text-center text-muted-foreground",children:0===t.length?"No background jobs found. Create a batch job by selecting 2+ posters in the Poster Manager.":"No jobs match your search criteria."})})}):v.map(e=>(0,a.jsx)(Z,{job:e,onJobUpdate:j,onProgressUpdate:f},e.job_id))}),t.length>0&&(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"pt-6",children:(0,a.jsxs)("div",{className:"text-sm text-muted-foreground text-center",children:["Showing ",v.length," of ",t.length," jobs"]})})})]})};var H=t(5365);let q=e=>{let{selectedPosters:s,onImmediateProcess:t,onBatchProcess:l,className:r=""}=e,n=s.length;return 0===n?(0,a.jsx)(H.Fc,{className:r,children:(0,a.jsx)(H.TN,{children:"Select one or more posters to begin badge processing."})}):1===n?(0,a.jsxs)(H.Fc,{className:r,children:[(0,a.jsx)(A.A,{className:"h-4 w-4"}),(0,a.jsxs)(H.TN,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Immediate Processing"})," - Your poster will be processed instantly with real-time preview."]}),(0,a.jsxs)(i.E,{variant:"secondary",className:"ml-2",children:[(0,a.jsx)(L.A,{className:"w-3 h-3 mr-1"}),"~5-30 seconds"]})]})]}):(0,a.jsxs)(H.Fc,{className:r,children:[(0,a.jsx)(D.A,{className:"h-4 w-4"}),(0,a.jsxs)(H.TN,{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Background Processing"})," - ",n," posters will be processed in the background with real-time progress tracking."]}),(0,a.jsxs)(i.E,{variant:"outline",className:"ml-2",children:[(0,a.jsx)(L.A,{className:"w-3 h-3 mr-1"}),"Track in Jobs tab"]})]})]})};var V=t(5057);let K=e=>{let{selectedPosters:s,onJobCreated:t,onCancel:r,className:i=""}=e,[n,o]=(0,l.useState)("Batch Processing - ".concat(new Date().toLocaleDateString())),[d,m]=(0,l.useState)(["audio","resolution"]),[h,p]=(0,l.useState)(!1),[g,j]=(0,l.useState)(null),f=e=>{m(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},v=async()=>{if(0===d.length)return void j("Please select at least one badge type");p(!0),j(null);try{let e=await fetch("/api/v1/workflow/jobs/batch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,badge_types:d,poster_ids:s.map(e=>e.id),user_id:"default_user"})});if(e.ok){let s=await e.json();t(s.job_id)}else{let s=await e.json();j(s.detail||"Failed to create batch job")}}catch(e){j("Network error while creating job"),console.error("Error creating batch job:",e)}finally{p(!1)}};return(0,a.jsxs)(c.Zp,{className:i,children:[(0,a.jsx)(c.aR,{children:(0,a.jsxs)(c.ZB,{className:"flex items-center",children:[(0,a.jsx)(J.A,{className:"w-5 h-5 mr-2"}),"Create Batch Processing Job"]})}),(0,a.jsxs)(c.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(V.J,{htmlFor:"job-name",children:"Job Name"}),(0,a.jsx)(w.p,{id:"job-name",value:n,onChange:e=>o(e.target.value),placeholder:"Enter a descriptive name for this job"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(V.J,{children:"Badge Types to Apply"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-3",children:[{id:"audio",label:"Audio Codec Badges",description:"DTS-HD MA, Atmos, etc."},{id:"resolution",label:"Resolution Badges",description:"4K HDR, 1080p, etc."},{id:"review",label:"Review Badges",description:"IMDb, TMDb, RT ratings"},{id:"awards",label:"Awards Badges",description:"Oscars, Emmys, etc."}].map(e=>(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(x.S,{id:"badge-".concat(e.id),checked:d.includes(e.id),onCheckedChange:()=>f(e.id)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)(V.J,{htmlFor:"badge-".concat(e.id),className:"text-sm font-medium cursor-pointer",children:e.label}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e.description})]})]},e.id))})]}),(0,a.jsx)(H.Fc,{children:(0,a.jsxs)(H.TN,{children:[(0,a.jsx)("strong",{children:"Job Summary:"})," ",s.length," posters will be processed with ",d.length," badge type",1!==d.length?"s":"",d.length>0&&" (".concat(d.join(", "),")"),"."]})}),g&&(0,a.jsx)(H.Fc,{variant:"destructive",children:(0,a.jsx)(H.TN,{children:g})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(y.$,{variant:"outline",onClick:r,disabled:h,children:"Cancel"}),(0,a.jsx)(y.$,{onClick:v,disabled:h||0===d.length,children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating Job..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(W.A,{className:"w-4 h-4 mr-2"}),"Start Batch Processing"]})})]})]})]})};var X=t(6671),Q=t(646),Y=t(1284);let ee=()=>{let e=(0,l.useCallback)((e,s)=>{X.oR.success((0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(Q.A,{className:"w-4 h-4 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e}),s&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:s})]})]}))},[]),s=(0,l.useCallback)((e,s)=>{X.oR.error((0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(O.A,{className:"w-4 h-4 text-red-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e}),s&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:s})]})]}),{duration:8e3})},[]),t=(0,l.useCallback)((e,s)=>{X.oR.info((0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(Y.A,{className:"w-4 h-4 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e}),s&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:s})]})]}))},[]),r=(0,l.useCallback)((e,s)=>{X.oR.info((0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(L.A,{className:"w-4 h-4 text-orange-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e}),s&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground mt-1",children:s})]})]}))},[]),i=(0,l.useCallback)((s,t)=>{e("Background Job Created","".concat(s," - Processing ").concat(t," posters"))},[e]),n=(0,l.useCallback)(function(t,a){let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;0===l?e("Job Completed Successfully","".concat(t," - All ").concat(a," posters processed")):s("Job Completed with Errors","".concat(t," - ").concat(a-l,"/").concat(a," posters processed, ").concat(l," failed"))},[e,s]),c=(0,l.useCallback)(e=>{t("Job Paused","".concat(e," has been paused"))},[t]),o=(0,l.useCallback)(e=>{t("Job Resumed","".concat(e," is now processing"))},[t]),d=(0,l.useCallback)(e=>{s("Job Cancelled","".concat(e," has been cancelled"))},[s]),m=(0,l.useCallback)(()=>{s("Connection Lost","Lost connection to job progress updates. Trying to reconnect...")},[s]),u=(0,l.useCallback)(()=>{e("Connection Restored","Real-time progress updates are working again")},[e]);return{showSuccess:e,showError:s,showInfo:t,showProgress:r,showJobCreated:i,showJobCompleted:n,showJobPaused:c,showJobResumed:o,showJobCancelled:d,showConnectionError:m,showConnectionRestored:u}};var es=t(5695);let et=e=>{let{selectedCount:s,selectedItems:t,allItems:r,onClearSelection:n,onRefreshItems:o,disabled:d=!1}=e,[m,u]=(0,l.useState)(!1),{showJobCreated:h}=ee(),x=(0,es.useRouter)(),p=r.filter(e=>t.has(e.id)),g=e=>{x.push("/preview?posterId=".concat(e.id))},j=()=>{u(!0)};return 0===s?null:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)(c.Zp,{children:[(0,a.jsx)(c.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(c.ZB,{className:"text-lg",children:[s," poster",1!==s?"s":""," selected"]}),(0,a.jsx)(i.E,{variant:"secondary",children:s})]}),(0,a.jsxs)(y.$,{variant:"outline",size:"sm",onClick:n,disabled:d,children:[(0,a.jsx)(C.A,{className:"h-4 w-4 mr-2"}),"Clear Selection"]})]})}),(0,a.jsxs)(c.Wu,{className:"space-y-4",children:[(0,a.jsx)(q,{selectedPosters:p,onImmediateProcess:g,onBatchProcess:j}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[1===s?(0,a.jsxs)(y.$,{onClick:()=>g(p[0]),disabled:d,className:"flex-1",children:[(0,a.jsx)(A.A,{className:"h-4 w-4 mr-2"}),"Generate Preview"]}):(0,a.jsxs)(y.$,{onClick:j,disabled:d,className:"flex-1",children:[(0,a.jsx)(D.A,{className:"h-4 w-4 mr-2"}),"Create Batch Job"]}),(0,a.jsx)(k.w,{orientation:"vertical",className:"h-8"}),(0,a.jsxs)(y.$,{variant:"outline",size:"sm",disabled:d,children:[(0,a.jsx)(E.A,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,a.jsxs)(y.$,{variant:"outline",size:"sm",disabled:d,children:[(0,a.jsx)(P.A,{className:"h-4 w-4 mr-2"}),"Bulk Edit"]})]})]})]}),m&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"max-w-2xl w-full",children:(0,a.jsx)(K,{selectedPosters:p,onJobCreated:e=>{h("Batch Job Created",s),u(!1),n()},onCancel:()=>u(!1)})})})]})};function ea(e){let{totalItems:s,selectedCount:t,allSelected:l,onSelectAll:r,onSelectNone:n,onToggleSelectionMode:c,selectionMode:o}=e;return o?(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.S,{checked:l,onCheckedChange:e=>{e?r():n()},className:t>0&&!l?"data-[state=indeterminate]:bg-primary":""}),(0,a.jsx)("label",{className:"text-sm font-medium",children:"Select All"})]}),(0,a.jsxs)(i.E,{variant:"secondary",className:"text-sm",children:[t," of ",s," selected"]})]}),(0,a.jsx)(y.$,{variant:"ghost",size:"sm",onClick:c,children:"Cancel Selection"})]}):(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(i.E,{variant:"outline",className:"text-sm",children:[s," item",1!==s?"s":""," total"]}),(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:c,children:"Select Items"})]})}var el=t(2278),er=t(2355),ei=t(3052),en=t(2767);function ec(e){let{currentPage:s,totalItems:t,itemsPerPage:l,onPageChange:r,onItemsPerPageChange:i,loading:c=!1}=e,o=Math.ceil(t/l),d=(s-1)*l+1,m=Math.min(s*l,t);return 0===t?null:(0,a.jsxs)("div",{className:"flex items-center justify-between px-2 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Showing ",d," to ",m," of ",t," items"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"Show:"}),(0,a.jsxs)(n.l6,{value:l.toString(),onValueChange:e=>i(parseInt(e)),disabled:c,children:[(0,a.jsx)(n.bq,{className:"w-20",children:(0,a.jsx)(n.yv,{})}),(0,a.jsxs)(n.gC,{children:[(0,a.jsx)(n.eb,{value:"25",children:"25"}),(0,a.jsx)(n.eb,{value:"50",children:"50"}),(0,a.jsx)(n.eb,{value:"100",children:"100"}),(0,a.jsx)(n.eb,{value:"200",children:"200"})]})]}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"per page"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground mr-4",children:["Page ",s," of ",o]}),(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:()=>r(1),disabled:1===s||c,children:(0,a.jsx)(el.A,{className:"h-4 w-4"})}),(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:()=>r(s-1),disabled:1===s||c,children:(0,a.jsx)(er.A,{className:"h-4 w-4"})}),Array.from({length:Math.min(5,o)},(e,t)=>{let l;return l=o<=5||s<=3?t+1:s>=o-2?o-4+t:s-2+t,(0,a.jsx)(y.$,{variant:l===s?"default":"outline",size:"sm",onClick:()=>r(l),disabled:c,className:"w-8",children:l},l)}),(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:()=>r(s+1),disabled:s===o||c,children:(0,a.jsx)(ei.A,{className:"h-4 w-4"})}),(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:()=>r(o),disabled:s===o||c,children:(0,a.jsx)(en.A,{className:"h-4 w-4"})})]})]})}var eo=t(4165),ed=t(7213),em=t(4616),eu=t(7712),eh=t(133),ex=t(8564),ep=t(3332),eg=t(9434);let ej=[{id:"audio",name:"Audio Codec",description:"DTS-HD MA, Atmos, Dolby Digital Plus, etc."},{id:"resolution",name:"Resolution",description:"4K, 1080p, HDR, Dolby Vision, etc."},{id:"review",name:"Reviews & Ratings",description:"IMDb, TMDb, Rotten Tomatoes, Metacritic"},{id:"awards",name:"Awards",description:"Oscars, Emmys, Golden Globes, etc."}];function ef(e){let{isOpen:s,onClose:t,onApply:r,isLoading:i}=e,[n,c]=(0,l.useState)([]),o=e=>{c(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},d=async()=>{if(0===n.length)return void X.oR.error("Please select at least one badge type");try{await r(n),c([])}catch(e){}},m=()=>{i||(c([]),t())};return(0,a.jsx)(eo.lG,{open:s,onOpenChange:m,children:(0,a.jsxs)(eo.Cf,{className:"max-w-md",children:[(0,a.jsx)(eo.c7,{children:(0,a.jsx)(eo.L3,{children:"Select Badges to Apply"})}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Choose which badge types to apply to this poster:"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:()=>{c(ej.map(e=>e.id))},disabled:i,children:"Select All"}),(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:()=>{c([])},disabled:i,children:"Select None"})]}),(0,a.jsx)(k.w,{}),(0,a.jsx)("div",{className:"space-y-3",children:ej.map(e=>(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(x.S,{id:e.id,checked:n.includes(e.id),onCheckedChange:()=>o(e.id),disabled:i}),(0,a.jsxs)("div",{className:"grid gap-1.5 leading-none",children:[(0,a.jsx)(V.J,{htmlFor:e.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},e.id))}),(0,a.jsx)(k.w,{}),(0,a.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,a.jsx)(y.$,{variant:"outline",onClick:m,disabled:i,children:"Cancel"}),(0,a.jsx)(y.$,{onClick:d,disabled:i||0===n.length,children:i?"Applying...":"Apply ".concat(n.length," Badge").concat(1!==n.length?"s":"")})]})]})]})})}var ev=t(6766);function eb(e){let{item:s,isOpen:t,onClose:r,onPosterReplaced:n,onRefreshGrid:c}=e,[o,d]=(0,l.useState)(!1),[m,u]=(0,l.useState)(!1),[h,x]=(0,l.useState)([]),[p,g]=(0,l.useState)(null),[j,f]=(0,l.useState)(null);(0,l.useEffect)(()=>{t&&s?v():(x([]),g(null),f(null))},[t,null==s?void 0:s.id]);let v=async()=>{if(s){d(!0),f(null);try{let t=await fetch("/api/v1/poster-replacement/items/".concat(s.id,"/poster-sources"));if(!t.ok)throw Error("Search failed: ".concat(t.status));let a=await t.json();if(a.success){var e;x(a.posters||[]),(null==(e=a.posters)?void 0:e.length)===0&&f("No alternative posters found from external sources")}else f(a.message||"Failed to search for posters")}catch(e){console.error("Error searching poster sources:",e),f("Search failed: ".concat(e.message))}finally{d(!1)}}},b=e=>{g(e)},N=async()=>{if(s&&p){u(!0);try{let e=await fetch("/api/v1/poster-replacement/items/".concat(s.id,"/replace-poster"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_id:s.id,jellyfin_id:s.jellyfin_id,selected_poster:p})});if(!e.ok){let s=await e.json().catch(()=>({}));throw Error(s.message||"Replace failed: ".concat(e.status))}let t=await e.json();if(t.success)n(s.id,t.new_poster_url),c&&c(),X.oR.success(t.message),r();else throw Error(t.message||"Failed to replace poster")}catch(e){console.error("Error replacing poster:",e),X.oR.error("Failed to replace poster: ".concat(e.message))}finally{u(!1)}}};return s?(0,a.jsx)(eo.lG,{open:t,onOpenChange:r,children:(0,a.jsxs)(eo.Cf,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(eo.c7,{children:(0,a.jsxs)(eo.L3,{className:"flex items-center gap-2",children:[(0,a.jsx)(S.A,{className:"h-5 w-5"}),"Replace Poster: ",s.title]})}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-blue-800",children:[(0,a.jsx)(S.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{className:"text-sm",children:["Searching external sources for alternative posters for ",(0,a.jsx)("strong",{children:s.title}),s.year&&" (".concat(s.year,")")]})]})}),o&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,a.jsx)(eN,{className:"h-8 w-8 mb-4"}),(0,a.jsx)("p",{children:"Searching external sources..."})]}),j&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-800",children:[(0,a.jsx)(C.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm",children:j})]})}),!o&&!j&&h.length>0&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Found ",h.length," alternative posters. Click to select:"]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:h.map(e=>{var s;return(0,a.jsxs)("div",{className:"cursor-pointer rounded-lg border-2 transition-all hover:shadow-lg ".concat((null==p?void 0:p.id)===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onClick:()=>b(e),children:[(0,a.jsxs)("div",{className:"relative aspect-[2/3] bg-muted rounded-t-lg overflow-hidden",children:[e.thumbnail_url&&(0,a.jsx)(ev.default,{src:e.thumbnail_url,alt:"".concat(e.source," poster"),fill:!0,className:"object-cover",onError:s=>{s.currentTarget.src=e.url}}),(0,a.jsx)("div",{className:"absolute top-2 left-2",children:(0,a.jsx)(i.E,{variant:"secondary",className:"text-xs",children:e.source.toUpperCase()})}),e.width&&e.height&&(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsxs)(i.E,{variant:"outline",className:"text-xs",children:[e.width,"\xd7",e.height]})}),(null==p?void 0:p.id)===e.id&&(0,a.jsx)("div",{className:"absolute inset-0 bg-blue-500 bg-opacity-20 flex items-center justify-center",children:(0,a.jsx)("div",{className:"bg-blue-500 text-white rounded-full p-2",children:(0,a.jsx)("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})})]}),(0,a.jsx)("div",{className:"p-3 space-y-1",children:(0,a.jsxs)("div",{className:"text-xs space-y-1",children:[e.language&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Language:"})," ",e.language]}),e.file_size_estimate&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Size:"})," ",e.file_size_estimate]}),e.vote_count&&e.vote_count>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Rating:"})," ",(null==(s=e.vote_average)?void 0:s.toFixed(1))||"N/A","/10 (",e.vote_count," votes)"]})]})})]},e.id)})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t",children:[(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:p&&(0,a.jsxs)(a.Fragment,{children:["Selected: ",p.source.toUpperCase()," poster",p.width&&p.height&&" (".concat(p.width,"\xd7").concat(p.height,")")]})}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(y.$,{variant:"outline",onClick:r,disabled:m,children:"Cancel"}),(0,a.jsx)(y.$,{onClick:N,disabled:!p||m,className:"min-w-[120px]",children:m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eN,{className:"h-4 w-4 mr-2"}),"Replacing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.A,{className:"h-4 w-4 mr-2"}),"Replace Poster"]})})]})]})]})}):null}let eN=e=>{let{className:s}=e;return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:(0,eg.cn)("animate-spin",s),children:(0,a.jsx)("path",{d:"M21 12a9 9 0 1 1-6.219-8.56"})})};function ew(e){let{item:s,isOpen:t,onClose:r,onTagUpdate:n,onPosterUpdate:c,onRefreshGrid:o}=e,[d,m]=(0,l.useState)(!1),[u,h]=(0,l.useState)(!1),[x,j]=(0,l.useState)(!1),[f,b]=(0,l.useState)(!1),[N,w]=(0,l.useState)(void 0),[S,C]=(0,l.useState)(!1),[_,A]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{s&&(w(void 0),m(!1),h(!1),j(!1),b(!1),C(!1))},[null==s?void 0:s.id]),!s)return null;let D=N||s.poster_url,E=async e=>{if(s)try{h(!0);let t=await fetch("add"===e?"/api/v1/poster-manager/tags/add":"/api/v1/poster-manager/tags/remove",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_ids:[s.id]})});if(!t.ok)throw Error("Failed to ".concat(e," tag"));let a=await t.json();if(a.success)n(s.id,"add"===e),X.oR.success("Tag ".concat("add"===e?"added":"removed"," successfully")),r();else throw Error(a.message||"Failed to ".concat(e," tag"))}catch(s){console.error("Error ".concat(e,"ing tag:"),s),X.oR.error("Failed to ".concat(e," tag"))}finally{h(!1)}},P=async()=>{if(s)try{b(!0);let e=await fetch("/api/v1/poster-manager/restore-original",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_id:s.id,jellyfin_id:s.jellyfin_id})});if(!e.ok){let s=await e.json().catch(()=>({}));throw Error(s.message||"Failed to restore original: ".concat(e.status))}let t=await e.json();if(t.success){let e=Date.now(),a=s.poster_url?"".concat(s.poster_url,"?restored=").concat(e):"/api/v1/images/proxy/image/".concat(s.jellyfin_id,"/thumbnail?restored=").concat(e);w(a),m(!1),n(s.id,!1),c(s.id,a),o&&o(),r(),X.oR.success(t.message)}else throw Error(t.message||"Failed to restore original poster")}catch(e){console.error("Error restoring original poster:",e),X.oR.error("Failed to restore original: ".concat(e.message))}finally{b(!1)}},T=async e=>{if(s)try{j(!0);let a=await fetch("/api/v1/poster-manager/apply-badges",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({item_id:s.id,jellyfin_id:s.jellyfin_id,badge_types:e})});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e.message||"Failed to apply badges: ".concat(a.status))}let l=await a.json();if(l.success){var t;let e=Date.now(),a="/api/v1/images/proxy/image/".concat(s.jellyfin_id,"/thumbnail?badged=").concat(e);w(a),m(!1),n(s.id,!0),c(s.id,a),o&&o(),C(!1),r(),X.oR.success("Badges applied successfully! (".concat((null==(t=l.applied_badges)?void 0:t.join(", "))||"Unknown badges",")"))}else throw Error(l.message||"Failed to apply badges")}catch(e){console.error("Error applying badges:",e),X.oR.error("Failed to apply badges: ".concat(e.message))}finally{j(!1)}};return(0,a.jsx)(eo.lG,{open:t,onOpenChange:r,children:(0,a.jsxs)(eo.Cf,{className:"max-w-7xl max-h-[95vh] overflow-y-auto",children:[(0,a.jsx)(eo.c7,{children:(0,a.jsx)(eo.L3,{className:"text-xl font-semibold",children:s.title})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"relative aspect-[2/3] bg-muted rounded-lg overflow-hidden",children:[(x||f)&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center z-10",children:(0,a.jsxs)("div",{className:"bg-background border rounded-lg p-4 flex flex-col items-center gap-2 shadow-lg",children:[(0,a.jsx)(eN,{className:"h-8 w-8 text-foreground"}),(0,a.jsx)("span",{className:"text-sm font-medium text-foreground",children:x?"Applying badges...":"Restoring original..."})]})}),D&&!d?(0,a.jsx)("img",{src:v(D),alt:s.title,className:"w-full h-full object-cover",onError:()=>m(!0)},D):(0,a.jsx)("div",{className:"flex items-center justify-center h-full bg-muted",children:(0,a.jsx)(p.A,{className:"h-16 w-16 text-muted-foreground"})}),(0,a.jsx)("div",{className:"absolute top-4 left-4",children:(0,a.jsx)(i.E,{variant:"BADGED"===s.badge_status?"destructive":"secondary",className:"text-sm",children:s.badge_status})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[(0,a.jsxs)(y.$,{onClick:()=>C(!0),disabled:x||f,className:"w-full",children:[(0,a.jsx)(ed.A,{className:"h-4 w-4 mr-2"}),"Apply Badges"]}),"ORIGINAL"===s.badge_status?(0,a.jsxs)(y.$,{onClick:()=>E("add"),disabled:u||x||f,variant:"outline",className:"w-full",children:[(0,a.jsx)(em.A,{className:"h-4 w-4 mr-2"}),"Add Aphrodite Tag"]}):(0,a.jsxs)(y.$,{onClick:()=>E("remove"),disabled:u||x||f,variant:"outline",className:"w-full",children:[(0,a.jsx)(eu.A,{className:"h-4 w-4 mr-2"}),"Remove Aphrodite Tag"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[(0,a.jsxs)(y.$,{onClick:()=>{A(!0)},disabled:x||f,variant:"outline",className:"w-full",children:[(0,a.jsx)(ed.A,{className:"h-4 w-4 mr-2"}),"Replace Poster"]}),(0,a.jsxs)(y.$,{onClick:P,disabled:x||f,variant:"outline",className:"w-full",children:[(0,a.jsx)(eh.A,{className:"h-4 w-4 mr-2"}),"Restore to Original"]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,a.jsx)(g.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:s.year||"Unknown Year"}),(0,a.jsx)(k.w,{orientation:"vertical",className:"h-4"}),(0,a.jsx)(i.E,{variant:"outline",className:"capitalize",children:s.type})]}),(s.community_rating||s.official_rating)&&(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[s.community_rating&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(ex.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:s.community_rating.toFixed(1)})]}),s.official_rating&&(0,a.jsx)(i.E,{variant:"secondary",className:"text-xs",children:s.official_rating})]})]}),(0,a.jsx)(k.w,{}),s.genres.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium flex items-center gap-2",children:[(0,a.jsx)(ep.A,{className:"h-4 w-4"}),"Genres"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:s.genres.map(e=>(0,a.jsx)(i.E,{variant:"outline",className:"text-xs",children:e},e))})]}),(0,a.jsx)(k.w,{}),s.overview&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Overview"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:s.overview})]}),(0,a.jsx)(k.w,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:"Technical Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs text-muted-foreground",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Jellyfin ID:"}),(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"font-mono break-all",children:s.jellyfin_id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Internal ID:"}),(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"font-mono break-all",children:s.id})]})]})]})]})]}),(0,a.jsx)(ef,{isOpen:S,onClose:()=>C(!1),onApply:T,isLoading:x}),(0,a.jsx)(eb,{item:s,isOpen:_,onClose:()=>A(!1),onPosterReplaced:(e,s)=>{w(s),m(!1),c(e,s),o&&o()},onRefreshGrid:o})]})})}var ey=t(5562),eS=t(7576),eC=t(722);let e_=()=>window.location.origin;function ek(){let[e,s]=(0,l.useState)("library"),[t,n]=(0,l.useState)(0),[o,d]=(0,l.useState)([]),[m,x]=(0,l.useState)(""),[p,g]=(0,l.useState)([]),[j,f]=(0,l.useState)(null),[v,b]=(0,l.useState)(!1),[w,S]=(0,l.useState)(!1),[C,k]=(0,l.useState)(""),[A,D]=(0,l.useState)("all"),[E,P]=(0,l.useState)(1),[R,J]=(0,l.useState)(50),[F,O]=(0,l.useState)(0),[L,I]=(0,l.useState)(!1),[B,W]=(0,l.useState)(new Set),[$,z]=(0,l.useState)(!1),[M,U]=(0,l.useState)(null),[Z,H]=(0,l.useState)(!1);(0,l.useEffect)(()=>{q();let e=setInterval(q,3e4);return()=>clearInterval(e)},[]),(0,l.useEffect)(()=>{V()},[]),(0,l.useEffect)(()=>{m&&(K(),Q())},[m]),(0,l.useEffect)(()=>{m&&(P(1),C||"all"!==A?Y(1):K(1))},[C,A]);let q=async()=>{try{var e;let s=(null==(e=(await eC.apiService.getJobs({user_id:"default_user"})).jobs)?void 0:e.filter(e=>["processing","paused","queued"].includes(e.status)))||[];n(s.length)}catch(e){console.log("Could not load job count:",e)}},V=async()=>{try{b(!0);let e=await fetch("".concat(e_(),"/api/v1/poster-manager/libraries"));if(!e.ok)throw Error("HTTP ".concat(e.status,": ").concat(e.statusText));let s=await e.json();d(s.libraries||[]),s.libraries&&s.libraries.length>0&&x(s.libraries[0].id)}catch(e){console.error("Error loading libraries:",e),X.oR.error("Failed to load Jellyfin libraries. Please check your connection.")}finally{b(!1)}},K=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(m)try{b(!0);let s=(e-1)*R,t=await fetch("".concat(e_(),"/api/v1/poster-manager/libraries/").concat(m,"/items?limit=").concat(R,"&offset=").concat(s));if(!t.ok)throw Error("HTTP ".concat(t.status,": ").concat(t.statusText));let a=await t.json();g(a.items||[]),O(a.total_count||0),I(a.has_more||!1),P(e)}catch(e){console.error("Error loading library items:",e),X.oR.error("Failed to load library items")}finally{b(!1)}},Q=async()=>{if(m)try{let e=await fetch("".concat(e_(),"/api/v1/poster-manager/libraries/").concat(m,"/stats"));if(!e.ok)throw Error("HTTP ".concat(e.status,": ").concat(e.statusText));let s=await e.json();f(s)}catch(e){console.error("Error loading library stats:",e)}},Y=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(m)try{b(!0);let s=(e-1)*R,t=new URLSearchParams({library_id:m,limit:R.toString(),offset:s.toString()});C.trim()&&t.append("query",C.trim()),"all"!==A&&t.append("badge_filter",A);let a=await fetch("".concat(e_(),"/api/v1/poster-manager/search?").concat(t));if(!a.ok)throw Error("HTTP ".concat(a.status,": ").concat(a.statusText));let l=await a.json();g(l.items||[]),O(l.total_count||0),I(l.has_more||!1),P(e)}catch(e){console.error("Error searching items:",e),X.oR.error("Failed to search items")}finally{b(!1)}},ee=async()=>{S(!0),await V(),m&&(await K(),await Q()),await q();let e=Date.now();g(s=>s.map(s=>{if(s.poster_url){let t=s.poster_url.includes("?")?"".concat(s.poster_url,"&refresh=").concat(e):"".concat(s.poster_url,"?refresh=").concat(e);return{...s,poster_url:t}}return s})),S(!1),X.oR.success("Library refreshed successfully")},es=()=>{W(new Set)},el=async()=>{m&&(C||"all"!==A?await Y(E):await K(E)),W(new Set),await q()},er=e=>{C||"all"!==A?Y(e):K(e),W(new Set),z(!1)},ei=e=>{J(e),P(1),C||"all"!==A?Y(1):K(1),W(new Set),z(!1)},en=p.length>0&&B.size===p.length;return(0,a.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Poster Manager"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Browse, manage, and process your Jellyfin library posters"})]}),(0,a.jsxs)(y.$,{onClick:ee,disabled:w,variant:"outline",children:[w?(0,a.jsx)(u.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,a.jsx)(T.A,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),(0,a.jsxs)(r.tU,{value:e,onValueChange:s,children:[(0,a.jsxs)(r.j7,{className:"grid w-full grid-cols-2",children:[(0,a.jsxs)(r.Xi,{value:"library",className:"flex items-center",children:[(0,a.jsx)(ey.A,{className:"h-4 w-4 mr-2"}),"Library"]}),(0,a.jsxs)(r.Xi,{value:"jobs",className:"flex items-center",children:[(0,a.jsx)(eS.A,{className:"h-4 w-4 mr-2"}),"Jobs",t>0&&(0,a.jsx)(i.E,{variant:"secondary",className:"ml-2",children:t})]})]}),(0,a.jsxs)(r.av,{value:"library",className:"space-y-6",children:[(0,a.jsx)(h,{libraries:o,selectedLibrary:m,onLibraryChange:x,loading:v}),j&&(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsx)(c.ZB,{children:"Library Overview"}),(0,a.jsx)(c.BT,{children:"Statistics for the selected library"})]}),(0,a.jsx)(c.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:j.total_items}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Items"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:j.movies}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Movies"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:j.tv_shows}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"TV Shows"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:j.genres.length}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Genres"})]})]})})]}),m&&(0,a.jsx)(_,{searchQuery:C,onSearchChange:k,badgeFilter:A,onBadgeFilterChange:D,onClearFilters:()=>{k(""),D("all")}}),m&&p.length>0&&(0,a.jsx)(ea,{totalItems:p.length,selectedCount:B.size,allSelected:en,onSelectAll:()=>{W(new Set(p.map(e=>e.id)))},onSelectNone:es,onToggleSelectionMode:()=>{z(!$),$&&W(new Set)},selectionMode:$}),(0,a.jsx)(et,{selectedCount:B.size,selectedItems:B,allItems:p,onClearSelection:es,onRefreshItems:el,disabled:v}),m&&(0,a.jsxs)(a.Fragment,{children:[F>0&&(0,a.jsx)(ec,{currentPage:E,totalItems:F,itemsPerPage:R,onPageChange:er,onItemsPerPageChange:ei,loading:v}),(0,a.jsx)(N,{items:p,loading:v,selectedItems:B,onSelectionChange:(e,s)=>{W(t=>{let a=new Set(t);return s?a.add(e):a.delete(e),a})},selectionMode:$,onPosterClick:e=>{U(e),H(!0)}}),F>0&&(0,a.jsx)(ec,{currentPage:E,totalItems:F,itemsPerPage:R,onPageChange:er,onItemsPerPageChange:ei,loading:v})]}),!m&&!v&&(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"flex flex-col items-center justify-center py-10",children:(0,a.jsx)("p",{className:"text-muted-foreground text-center",children:"Select a library to view your media posters"})})})]}),(0,a.jsx)(r.av,{value:"jobs",children:(0,a.jsx)(G,{})})]}),(0,a.jsx)(ew,{item:M,isOpen:Z,onClose:()=>{H(!1),U(null)},onTagUpdate:(e,s)=>{g(t=>t.map(t=>{if(t.id===e){if(!s&&t.poster_url){let e=Date.now(),s=t.poster_url.includes("?")?"".concat(t.poster_url,"&refresh=").concat(e):"".concat(t.poster_url,"?refresh=").concat(e);return{...t,badge_status:"ORIGINAL",poster_url:s}}return{...t,badge_status:s?"BADGED":"ORIGINAL"}}return t}))},onPosterUpdate:(e,s)=>{let t=s.includes("?restored="),a=s.includes("?badged=");g(l=>l.map(l=>{if(l.id===e){let e=Date.now(),r=s.includes("?")?"".concat(s,"&t=").concat(e):"".concat(s,"?t=").concat(e);return{...l,poster_url:r,badge_status:t?"ORIGINAL":a?"BADGED":l.badge_status}}return l}))},onRefreshGrid:el})]})}},7313:(e,s,t)=>{"use strict";t.d(s,{Xi:()=>c,av:()=>o,j7:()=>n,tU:()=>i});var a=t(5155);t(2115);var l=t(704),r=t(9434);function i(e){let{className:s,...t}=e;return(0,a.jsx)(l.bL,{"data-slot":"tabs",className:(0,r.cn)("flex flex-col gap-2",s),...t})}function n(e){let{className:s,...t}=e;return(0,a.jsx)(l.B8,{"data-slot":"tabs-list",className:(0,r.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",s),...t})}function c(e){let{className:s,...t}=e;return(0,a.jsx)(l.l9,{"data-slot":"tabs-trigger",className:(0,r.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...t})}function o(e){let{className:s,...t}=e;return(0,a.jsx)(l.UC,{"data-slot":"tabs-content",className:(0,r.cn)("flex-1 outline-none",s),...t})}},8889:(e,s,t)=>{Promise.resolve().then(t.bind(t,6304))}},e=>{var s=s=>e(e.s=s);e.O(0,[455,671,904,433,47,211,780,33,369,441,684,358],()=>s(8889)),_N_E=e.O()}]);